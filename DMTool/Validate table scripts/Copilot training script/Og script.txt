UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC, 'ACTIVEFROM HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_BankAccountEntity
	WHERE
		ACTIVEFROM IS NOT NULL AND ISDATE(ACTIVEFROM) = 0

UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC, 'ACTIVETO HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_BankAccountEntity
	WHERE
		ACTIVETO IS NOT NULL AND ISDATE(ACTIVETO) = 0

UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'CREDITLIMIT is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_BankAccountEntity	
	WHERE 
		CREDITLIMIT LIKE '%[^0-9.]%' AND CREDITLIMIT IS NOT NULL

UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'RFCNUMBER is not an integer','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_BankAccountEntity	
	WHERE 
		RFCNUMBER LIKE '%[^0-9]%' AND RFCNUMBER IS NOT NULL

UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC, 'ACTIVEFROM should not be greater than ACTIVETO','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_BankAccountEntity
	WHERE
		ACTIVEFROM IS NOT NULL AND
	    	ACTIVETO IS NOT NULL AND
		ACTIVEFROM > ACTIVETO 


UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'AccountNumber is blank when IBAN IS NOT blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		(AccountNumber= '' or AccountNumber is null) AND IBAN IS NOT NULL

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'CurrencyCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		CurrencyCode= '' or CurrencyCode is null

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'BankGroupId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		BankGroupId= '' or BankGroupId is null

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'BankAccountId,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		BankAccountId IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(BankAccountId,DATAAREAID) IN 
		(SELECT CONCAT(BankAccountId,DATAAREAID) FROM PWC_T_BankAccountEntity
		GROUP BY BankAccountId,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'CurrencyCode,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		BankGroupID IS NOT NULL AND CurrencyCode IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(BankGroupID,CurrencyCode,DATAAREAID) IN 
		(SELECT CONCAT(BankGroupID,CurrencyCode,DATAAREAID) FROM PWC_T_BankAccountEntity
		GROUP BY BankGroupID,CurrencyCode,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'CurrencyCode,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		CurrencyCode IS NOT NULL AND CONCAT(BankGroupID,CurrencyCode,DATAAREAID) IN 
		(SELECT CONCAT(CurrencyCode,DATAAREAID) FROM PWC_T_BankAccountEntity
		GROUP BY CurrencyCode,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'BankAccountStatus enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		BankAccountStatus IS NOT NULL AND BankAccountStatus NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'BankAccountHoldStatus')

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'RoutingNumberType enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		RoutingNumberType IS NOT NULL AND RoutingNumberType NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'BankCodeType')

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'CurrencyCode is not there in CURRENCYID of Currencies','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity A
	WHERE 
		CurrencyCode IS NOT NULL AND CurrencyCode NOT IN 
		(SELECT B.CURRENCYID FROM PWC_E_CURRENCYENTITY B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.CURRENCYID IS NOT NULL)

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC,'BankGroupId not in GROUPID of Bank Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_T_BankAccountEntity A
	WHERE 
		BankGroupId IS NOT NULL AND BankGroupId NOT IN 
		(SELECT B.GROUPID FROM PWC_E_BANKGROUPENTITY B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPID IS NOT NULL)

UPDATE PWC_E_BankAccountEntity
	SET ERRORDESC = CONCAT(ERRORDESC, 'ADDRESSCOUNTRYREGIONID, ADDRESSCITY is not matching with the City master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_BankAccountEntity 
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND
		ADDRESSCITY IS NOT NULL AND
		CONCAT(ADDRESSCOUNTRYREGIONID, ADDRESSCITY) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME) FROM PWC_E_LogisticsAddressCityEntity B)

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'AccountNumber exceeds max length 48','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		LEN(AccountNumber) > 48

UPDATE PWC_T_BankAccountEntity
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'IBAN exceeds max length 40','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_T_BankAccountEntity
	WHERE 
		LEN(IBAN) > 40
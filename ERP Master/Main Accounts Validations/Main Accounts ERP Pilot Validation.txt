Main Accounts ERP Pilot Validation script
Main Accounts	PWC_E_MAINACCOUNT
Main Acc Legal Entity Override	PWC_E_MAINACCLEGALENTOVERRIDE
Financial Dimension	PWC_E_FINDIM
Financial Dimension Values	PWC_E_FINDIMVALUES
Financial Dimension Legal Entity Override	PWC_E_FINDIMLEOVERRIDE
Dimension Value Translation 	PWC_E_DIMENSIONVALTRANS
Financial Dimension Translation	PWC_E_FINDIMTRANS
Main Acc Categories	PWC_E_MAINACCCATEGORY
Derived Dimensions	PWC_E_DERIVEDDIM
Account Structures	PWC_E_ACCSTRUCTURES





----------------> Chart of Accounts

CHARTOFACCOUNTS is null --- Error --- 2
DESCRIPTION is null --- Warning --- 3

CHARTOFACCOUNTS has duplicate values --- Error --- 2






---------> Main Account

NAME is null --- Error --- 2
CHARTOFACCOUNTS is null --- Error --- 2
MAINACCOUNTID is null --- Error --- 2
ACCOUNTCATEGORYDESCRIPTION is null --- Warning --- 3
DEBITCREDITDEFAULT is null --- Warning --- 3
DONOTALLOWMANUALENTRY is null --- Warning --- 3
MAINACCOUNTCATEGORY is null --- Warning --- 3
MAINACCOUNTTYPE is null --- Warning --- 3

CHARTOFACCOUNTS, MAINACCOUNTID has duplicate values --- Constraint --- 1

DebCredProposal
DEBITCREDITDEFAULT has invalid enum values --- Error --- 2
DimensionLedgerAccountType
MAINACCOUNTTYPE has invalid enum values --- Error --- 2

CHARTOFACCOUNTS is not there in CHARTOFACCOUNTS of Chart of Accounts --- Error --- 2
MAINACCOUNTCATEGORY is not there in MAINACCOUNTCATEGORY of Main Account Categories --- Error --- 2






-------> Main Acc Legal Entity Override

LEGALENTITYID is null --- Error --- 2
MAINACCOUNTID is null --- Warning --- 3
CHARTOFACCOUNTS is null --- Warning --- 3
ISEXEMPT is null --- Warning --- 3
ISSUSPENDED is null --- Warning --- 3
DONOTALLOWMANUALENTRY is null --- Warning --- 3

MAINACCOUNTID, CHARTOFACCOUNTS, LEGALENTITYID have duplicate values --- Constraint --- 1

LEGALENTITYID is not there in LEGALENTITYID of Legal Entities --- Error --- 2
MAINACCOUNTID is not there in MAINACCOUNTID of Main Accounts --- Error --- 2
CHARTOFACCOUNTS is not there in CHARTOFACCOUNTS of Chart of Accounts --- Error --- 2






------> Financial Dimensions

DIMENSIONNAME is null --- Error
UseValuesFrom is null --- Warning

DIMENSIONNAME has duplicate values --- Constraint --- 1





------ Financial Dimension Values

FINANCIALDIMENSION is null --- Error --- 1
DIMENSIONVALUE is null --- Error --- 1
DESCRIPTION is null --- Warning

FINANCIALDIMENSION, LEGALENTITYID, DIMENSIONVALUE has duplicate values --- Error --- 2

FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions --- Error --- 2
LEGALENTITYID is not there in in LEGALENTITYID of legal entities --- Error --- 2
OWNER is not there in PERSONNELNUMBER of Employee --- Error --- 2






------> Financial Dimension LE Override

FINANCIALDIMENSION is null --- Warning --- 3
DIMENSIONVALUE is null --- Warning --- 3
LEGALENTITYID is null --- Warning --- 3

FINANCIALDIMENSION, DIMENSIONVALUE, LEGALENTITYID has duplicate values --- Constraint --- 1

FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions --- Error --- 2
LEGALENTITYID is not there in LEGALENTITYID of legal entities







---------Financial Dimension Translations

FINANCIALDIMENSION is blank --- Warning --- 3
LANGUAGECODE is blank --- Warning --- 3
TRANSLATEDFINANCIALDIMENSION is blank --- Warning --- 3

FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions --- Error --- 2
LANGUAGECODE is not there in LanguageCodeId of Language --- Error --- 2

FINANCIALDIMENSION and LANGUAGECODE has duplicate values --- Constraint --- 1








------------- Dimension Value translations 

FINANCIALDIMENSION is blank --- Warning --- 3
LANGUAGECODE is blank --- Warning --- 3
FINANCIALDIMENSIONVALUE is blank --- Warning --- 3
TRANSLATEDDESCRIPTION is blank --- Warning --- 3

FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions --- Error --- 2
LANGUAGECODE is not there in LanguageCodeId of Language --- Error --- 2

FINANCIALDIMENSION, LANGUAGECODE and FINANCIALDIMENSIONVALUE has duplicate values --- Constraint --- 1







Derived Dimensions--

DRIVINGDIMENSION is blank --- Warning --- 3
DERIVEDDIMENSION1 is blank --- Warning --- 3
PREVENTCHANGES1 is blank --- Warning --- 3

DRIVINGDIMENSION has duplicate values --- Constraint --- 1





------------Main Account Category

MAINACCOUNTCATEGORY is blank --- Error --- 2
DESCRIPTION is blank --- Warning --- 3
MAINACCOUNTTYPE is blank --- Warning --- 3
DISPLAYORDER is blank --- Warning --- 3

DimensionLedgerAccCategoryAccountType
MAINACCOUNTTYPE enum has invalid enum values --- Error --- 2








Account Structures---

ACCOUNTSTRUCTURENAME is blank --- Error --- 2
STATUS is blank --- Warning --- 3
SEGMENTNAME10 is blank --- Warning --- 3
SEGMENTNAME11 is blank --- Warning --- 3
DESCRIPTION is blank --- Warning --- 3

DimensionHierarchyConstraintStatus
STATUS enum has invalid enum values --- Error --- 2

ACCOUNTSTRUCTURENAME and STATUS has duplicate values --- Constraint --- 1





------------------------------------------Validation Script--------------------------------------------

----------------> Chart of Accounts

UPDATE PWC_E_CHARTOFACC
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CHARTOFACC
	WHERE 
		CHARTOFACCOUNTS= '' or CHARTOFACCOUNTS is null

UPDATE PWC_E_CHARTOFACC
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CHARTOFACC
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_CHARTOFACC
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CHARTOFACC
	WHERE 
		CHARTOFACCOUNTS IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(CHARTOFACCOUNTS,DATAAREAID) IN 
		(SELECT CONCAT(CHARTOFACCOUNTS,DATAAREAID) FROM PWC_E_CHARTOFACC
		GROUP BY CHARTOFACCOUNTS,DATAAREAID HAVING COUNT(*)>1)










---------> Main Account

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'NAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		NAME= '' or NAME is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		CHARTOFACCOUNTS= '' or CHARTOFACCOUNTS is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		MAINACCOUNTID= '' or MAINACCOUNTID is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'DEBITCREDITDEFAULT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		DEBITCREDITDEFAULT= '' or DEBITCREDITDEFAULT is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'DONOTALLOWMANUALENTRY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		DONOTALLOWMANUALENTRY= '' or DONOTALLOWMANUALENTRY is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTCATEGORY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		MAINACCOUNTCATEGORY= '' or MAINACCOUNTCATEGORY is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		MAINACCOUNTTYPE= '' or MAINACCOUNTTYPE is null

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS,MAINACCOUNTID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE 
		CHARTOFACCOUNTS IS NOT NULL AND MAINACCOUNTID IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(CHARTOFACCOUNTS,MAINACCOUNTID,DATAAREAID) IN 
		(SELECT CONCAT(CHARTOFACCOUNTS,MAINACCOUNTID,DATAAREAID) FROM PWC_E_MAINACCOUNT
		GROUP BY CHARTOFACCOUNTS,MAINACCOUNTID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'DEBITCREDITDEFAULT has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE
		DEBITCREDITDEFAULT IS NOT NULL AND DEBITCREDITDEFAULT NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'DebCredProposal')

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'DEBITCREDITDEFAULT has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT
	WHERE
		DEBITCREDITDEFAULT IS NOT NULL AND DEBITCREDITDEFAULT NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'DebCredProposal')

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS is not there in CHARTOFACCOUNTS of Chart of Accounts','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT A
	WHERE
		CHARTOFACCOUNTS IS NOT NULL AND CHARTOFACCOUNTS NOT IN 
		(SELECT B.CHARTOFACCOUNTS FROM PWC_E_CHARTOFACC B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.CHARTOFACCOUNTS IS NOT NULL)

UPDATE PWC_E_MAINACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTCATEGORY is not there in MAINACCOUNTCATEGORY of Main Account Categories','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCOUNT A
	WHERE
		MAINACCOUNTCATEGORY IS NOT NULL AND MAINACCOUNTCATEGORY NOT IN 
		(SELECT B.MAINACCOUNTCATEGORY FROM PWC_E_MAINACCCATEGORY B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.MAINACCOUNTCATEGORY IS NOT NULL)















-------> Main Acc Legal Entity Override

MAINACCOUNTTYPE

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTID of Type Total has the field ISSUSPENDED Yes by default, so no record reqd here','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE A
	WHERE 
		MAINACCOUNTID IS NOT NULL AND MAINACCOUNTID IN 
		(SELECT B.MAINACCOUNTID FROM PWC_E_MAINACCOUNT B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.MAINACCOUNTID IS NOT NULL AND B.MAINACCOUNTTYPE IS NOT NULL AND B.MAINACCOUNTTYPE LIKE 'TOT%')


UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'LEGALENTITYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE
	WHERE 
		LEGALENTITYID= '' or LEGALENTITYID is null

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE
	WHERE 
		MAINACCOUNTID= '' or MAINACCOUNTID is null

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE
	WHERE 
		CHARTOFACCOUNTS= '' or CHARTOFACCOUNTS is null

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISSUSPENDED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE
	WHERE 
		ISSUSPENDED= '' or ISSUSPENDED is null

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTID,CHARTOFACCOUNTS,LEGALENTITYID,DATAAREAID have duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE
	WHERE
		MAINACCOUNTID IS NOT NULL AND 
		CHARTOFACCOUNTS IS NOT NULL AND 
		LEGALENTITYID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(MAINACCOUNTID,CHARTOFACCOUNTS,LEGALENTITYID,DATAAREAID) IN 
		(SELECT CONCAT(MAINACCOUNTID,CHARTOFACCOUNTS,LEGALENTITYID,DATAAREAID) FROM PWC_E_MAINACCLEGALENTOVERRIDE
		GROUP BY MAINACCOUNTID,CHARTOFACCOUNTS,LEGALENTITYID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTID is not there in MAINACCOUNTID of Main Accounts','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE A
	WHERE 
		MAINACCOUNTID IS NOT NULL AND MAINACCOUNTID NOT IN 
		(SELECT B.MAINACCOUNTID FROM PWC_E_MAINACCOUNT B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.MAINACCOUNTID IS NOT NULL)

UPDATE PWC_E_MAINACCLEGALENTOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'CHARTOFACCOUNTS is not there in CHARTOFACCOUNTS of Chart of Accounts','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCLEGALENTOVERRIDE A
	WHERE 
		CHARTOFACCOUNTS IS NOT NULL AND CHARTOFACCOUNTS NOT IN 
		(SELECT B.CHARTOFACCOUNTS FROM PWC_E_CHARTOFACC B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.CHARTOFACCOUNTS IS NOT NULL)














------> Financial Dimensions

UPDATE PWC_E_FINDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DIMENSIONNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIM
	WHERE 
		DIMENSIONNAME= '' or DIMENSIONNAME is null

UPDATE PWC_E_FINDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'UseValuesFrom is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIM
	WHERE 
		UseValuesFrom= '' or UseValuesFrom is null

UPDATE PWC_E_FINDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DIMENSIONNAME,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIM
	WHERE 
		DIMENSIONNAME IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(DIMENSIONNAME,DATAAREAID) IN 
		(SELECT CONCAT(DIMENSIONNAME,DATAAREAID) FROM PWC_E_FINDIM
		GROUP BY DIMENSIONNAME,DATAAREAID HAVING COUNT(*)>1)












------ Financial Dimension Values

UPDATE PWC_E_FINDIMVALUES
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMVALUES
	WHERE 
		FINANCIALDIMENSION= '' or FINANCIALDIMENSION is null

UPDATE PWC_E_FINDIMVALUES
	SET ERRORDESC = CONCAT(ERRORDESC,'DIMENSIONVALUE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMVALUES
	WHERE 
		DIMENSIONVALUE= '' or DIMENSIONVALUE is null

UPDATE PWC_E_FINDIMVALUES
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIMVALUES
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_FINDIMVALUES
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION,DIMENSIONVALUE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_FINDIMVALUES
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND 
		DIMENSIONVALUE IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(FINANCIALDIMENSION,DIMENSIONVALUE,DATAAREAID) IN 
		(SELECT CONCAT(FINANCIALDIMENSION,DIMENSIONVALUE,DATAAREAID) FROM PWC_E_FINDIMVALUES
		GROUP BY FINANCIALDIMENSION,DIMENSIONVALUE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_FINDIMVALUES
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMVALUES A
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND FINANCIALDIMENSION NOT IN 
		(SELECT B.DIMENSIONNAME FROM PWC_E_FINDIM B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONNAME IS NOT NULL)















------> Financial Dimension LE Override

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISSUSPENDED is not "Yes"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE
	WHERE 
		UPPER(ISSUSPENDED) NOT LIKE 'YES'

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE
	WHERE 
		FINANCIALDIMENSION= '' or FINANCIALDIMENSION is null

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'DIMENSIONVALUE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE
	WHERE 
		DIMENSIONVALUE= '' or DIMENSIONVALUE is null

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'LEGALENTITYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE
	WHERE 
		LEGALENTITYID= '' or LEGALENTITYID is null

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION,DIMENSIONVALUE,LEGALENTITYID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE
	WHERE
		FINANCIALDIMENSION IS NOT NULL AND 
		LEGALENTITYID IS NOT NULL AND 
		DIMENSIONVALUE IS NOT NULL AND
		DATAAREAID IS NOT NULL AND 
		CONCAT(FINANCIALDIMENSION, LEGALENTITYID,DIMENSIONVALUE,DATAAREAID) IN 
		(SELECT CONCAT(FINANCIALDIMENSION,LEGALENTITYID,DIMENSIONVALUE,DATAAREAID) FROM PWC_E_FINDIMLEOVERRIDE
		GROUP BY FINANCIALDIMENSION,LEGALENTITYID,DIMENSIONVALUE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE A
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND FINANCIALDIMENSION NOT IN 
		(SELECT B.DIMENSIONNAME FROM PWC_E_FINDIM B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONNAME IS NOT NULL)

UPDATE PWC_E_FINDIMLEOVERRIDE
	SET ERRORDESC = CONCAT(ERRORDESC,'DIMENSIONVALUE, FINANCIALDIMENSION is not matching with Financial Dimension Values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMLEOVERRIDE A
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND DIMENSIONVALUE IS NOT NULL AND CONCAT(FINANCIALDIMENSION,DIMENSIONVALUE) NOT IN 
		(SELECT CONCAT(B.FINANCIALDIMENSION,B.DIMENSIONVALUE) FROM PWC_E_FINDIMVALUES B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.FINANCIALDIMENSION IS NOT NULL)




















------------Financial Dimension Translations

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIMTRANS
	WHERE 
		FINANCIALDIMENSION= '' or FINANCIALDIMENSION is null

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGECODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIMTRANS
	WHERE 
		LANGUAGECODE= '' or LANGUAGECODE is null

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'TRANSLATEDFINANCIALDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_FINDIMTRANS
	WHERE 
		TRANSLATEDFINANCIALDIMENSION= '' or TRANSLATEDFINANCIALDIMENSION is null

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMTRANS A
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND FINANCIALDIMENSION NOT IN 
		(SELECT B.DIMENSIONNAME FROM PWC_E_FINDIM B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONNAME IS NOT NULL)

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGECODE is not there in LanguageCodeId of Language','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_FINDIMTRANS A
	WHERE 
		LANGUAGECODE IS NOT NULL AND LANGUAGECODE NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)

UPDATE PWC_E_FINDIMTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION,LANGUAGECODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_FINDIMTRANS
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND LANGUAGECODE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(FINANCIALDIMENSION,LANGUAGECODE,DATAAREAID) IN 
		(SELECT CONCAT(FINANCIALDIMENSION,LANGUAGECODE,DATAAREAID) FROM PWC_E_FINDIMTRANS
		GROUP BY FINANCIALDIMENSION,LANGUAGECODE,DATAAREAID HAVING COUNT(*)>1)

















----------Dimension Value translations

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DIMENSIONVALTRANS
	WHERE 
		FINANCIALDIMENSION= '' or FINANCIALDIMENSION is null

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGECODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DIMENSIONVALTRANS
	WHERE 
		LANGUAGECODE= '' or LANGUAGECODE is null

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSIONVALUE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DIMENSIONVALTRANS
	WHERE 
		FINANCIALDIMENSIONVALUE= '' or FINANCIALDIMENSIONVALUE is null

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'TRANSLATEDDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DIMENSIONVALTRANS
	WHERE 
		TRANSLATEDDESCRIPTION= '' or TRANSLATEDDESCRIPTION is null

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION is not there in DIMENSIONNAME of Financial Dimensions','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DIMENSIONVALTRANS A
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND FINANCIALDIMENSION NOT IN 
		(SELECT B.DIMENSIONNAME FROM PWC_E_FINDIM B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONNAME IS NOT NULL)

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGECODE is not there in LanguageCodeId of Language','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DIMENSIONVALTRANS A
	WHERE 
		LANGUAGECODE IS NOT NULL AND LANGUAGECODE NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)

UPDATE PWC_E_DIMENSIONVALTRANS
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSION,LANGUAGECODE,FINANCIALDIMENSIONVALUE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_DIMENSIONVALTRANS
	WHERE 
		FINANCIALDIMENSION IS NOT NULL AND LANGUAGECODE IS NOT NULL AND FINANCIALDIMENSIONVALUE IS NOT NULL AND DATAAREAID IS NOT NULL AND
		CONCAT(FINANCIALDIMENSION,LANGUAGECODE,FINANCIALDIMENSIONVALUE,DATAAREAID) IN 
		(SELECT CONCAT(FINANCIALDIMENSION,LANGUAGECODE,FINANCIALDIMENSIONVALUE,DATAAREAID) FROM PWC_E_DIMENSIONVALTRANS
		GROUP BY FINANCIALDIMENSION,LANGUAGECODE,FINANCIALDIMENSIONVALUE,DATAAREAID HAVING COUNT(*)>1)




















-------- Derived Dimensions

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC, 'PREVENTCHANGES1 HAS WRONG BOOLEAN FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_DERIVEDDIM
	WHERE
		PREVENTCHANGES1 IS NOT NULL AND LOWER(PREVENTCHANGES1) NOT IN ('YES','NO')

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DRIVINGDIMENSION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DERIVEDDIM
	WHERE 
		DRIVINGDIMENSION= '' or DRIVINGDIMENSION is null

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DERIVEDDIMENSION1 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DERIVEDDIM
	WHERE 
		DERIVEDDIMENSION1= '' or DERIVEDDIMENSION1 is null

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'PREVENTCHANGES1 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DERIVEDDIM
	WHERE 
		PREVENTCHANGES1= '' or PREVENTCHANGES1 is null

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DRIVINGDIMENSION,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_DERIVEDDIM
	WHERE
		DRIVINGDIMENSION IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(DIMENSIONNAME,DATAAREAID) IN 
		(SELECT CONCAT(DIMENSIONNAME,DATAAREAID) FROM PWC_E_DERIVEDDIM
		GROUP BY DRIVINGDIMENSION,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DRIVINGDIMENSION is not there in DIMENSIONVALUE of Financial Dimension vales','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DERIVEDDIM A
	WHERE 
		DRIVINGDIMENSION IS NOT NULL AND DRIVINGDIMENSION NOT IN 
		(SELECT B.DIMENSIONVALUE FROM PWC_E_FINDIMVALUES B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONVALUE IS NOT NULL)

UPDATE PWC_E_DERIVEDDIM
	SET ERRORDESC = CONCAT(ERRORDESC,'DERIVEDDIMENSION1 is not there in DIMENSIONVALUE of Financial Dimension Values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DERIVEDDIM A
	WHERE 
		DERIVEDDIMENSION1 IS NOT NULL AND DERIVEDDIMENSION1 NOT IN 
		(SELECT B.DIMENSIONVALUE FROM PWC_E_FINDIMVALUES B WHERE  (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.DIMENSIONVALUE IS NOT NULL)

















-----------Main Account Category

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTCATEGORY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		MAINACCOUNTCATEGORY= '' or MAINACCOUNTCATEGORY is null

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'REFERENCEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		REFERENCEID= '' or REFERENCEID is null

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		MAINACCOUNTTYPE= '' or MAINACCOUNTTYPE is null

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'DISPLAYORDER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		DISPLAYORDER= '' or DISPLAYORDER is null

UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'MAINACCOUNTTYPE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE 
		MAINACCOUNTTYPE IS NOT NULL AND MAINACCOUNTTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'DimensionLedgerAccCategoryAccountType')


UPDATE PWC_E_MAINACCCATEGORY
	SET ERRORDESC = CONCAT(ERRORDESC,'REFERENCEID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_MAINACCCATEGORY
	WHERE
		REFERENCEID IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(REFERENCEID,DATAAREAID) IN 
		(SELECT CONCAT(REFERENCEID,DATAAREAID) FROM PWC_E_MAINACCCATEGORY
		GROUP BY REFERENCEID,DATAAREAID HAVING COUNT(*)>1)



















--------------Account Structures

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'ACCOUNTSTRUCTURENAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		ACCOUNTSTRUCTURENAME= '' or ACCOUNTSTRUCTURENAME is null

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'STATUS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		STATUS= '' or STATUS is null

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'SEGMENTNAME10 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		SEGMENTNAME10= '' or SEGMENTNAME10 is null

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'SEGMENTNAME11 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		SEGMENTNAME11= '' or SEGMENTNAME11 is null

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'STATUS enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		STATUS IS NOT NULL AND STATUS NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'DimensionHierarchyConstraintStatus')

UPDATE PWC_E_ACCSTRUCTURES
	SET ERRORDESC = CONCAT(ERRORDESC,'ACCOUNTSTRUCTURENAME,STATUS,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ACCSTRUCTURES
	WHERE 
		ACCOUNTSTRUCTURENAME IS NOT NULL AND STATUS IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(ACCOUNTSTRUCTURENAME,STATUS,DATAAREAID) IN 
		(SELECT CONCAT(ACCOUNTSTRUCTURENAME,STATUS,DATAAREAID) FROM PWC_E_ACCSTRUCTURES
		GROUP BY ACCOUNTSTRUCTURENAME,STATUS,DATAAREAID HAVING COUNT(*)>1)








Address---
Validation Rules--

Country-
COUNTRYREGION is blank --- Error --- 2
ADDRESSFORMAT is blank --- Error --- 2
ISOCODE is blank --- Warning --- 3
TIMEZONE is blank --- Warning --- 3
COUNTRYREGION has duplicate values --- Constraint --- 1
timezone
TIMEZONE enum has invalid enum values --- Error --- 2

Country region translation-
COUNTRYREGIONID is blank --- Error --- 2
LANGUAGEID is blank --- Error --- 2
LONGNAME is blank --- Warning --- 3
SHORTNAME is blank --- Warning --- 3
COUNTRYREGIONID has duplicate values --- Constraint --- 1
COUNTRYREGIONID is not there in COUNTRYREGION of Country --- Error --- 2
LANGUAGEID is not there in LanguageCodeId of Language --- Error --- 2

State-
COUNTRYREGIONID is blank --- Error --- 2
STATE is blank --- Error --- 2
NAME is blank --- Warning --- 3
TIMEZONE is blank --- Warning --- 3
COUNTRYREGIONID has duplicate values --- Constraint --- 1
COUNTRYREGIONID is not there in COUNTRYREGION of Country --- Error --- 2
timezone
TIMEZONE enum has invalid enum values --- Error --- 2

City-
CITYKEY is blank --- Error --- 2
COUNTRYREGIONID is blank --- Error --- 2
NAME is blank --- Error --- 2
COUNTYID is blank --- Warning --- 3
DESCRIPTION is blank --- Warning --- 3
STATEID is blank --- Warning --- 3
COUNTRYREGIONID and STATEID has duplicate values --- Constraint --- 1
COUNTRYREGIONID is not there in COUNTRYREGION of Country --- Error --- 2
STATEID is not there in STATE of state --- Error --- 2

Zipcode-
ZIPCODE is blank --- Error --- 2
COUNTRYREGIONID is blank --- Error --- 2
STATEID is blank --- Warning --- 3
COUNTYID is blank --- Warning --- 3
CITYID is blank --- Warning --- 3
DISTRICTID is blank --- Warning --- 3
TIMEZONE is blank --- Warning --- 3
COUNTRYREGIONID is not there in COUNTRYREGION of Country --- Error --- 2
STATEID is not there in STATE of state --- Error --- 2
CITYID is not there in NAME of City --- Error --- 2

ZIPCODE,COUNTRYREGIONID,STATEID,CITYID,DISTRICTID,TIMEZONE,DATAAREAID has duplicate values --- Constraint --- 1

timezone
TIMEZONE enum has invalid enum values --- Error --- 2


Validation script--

Country-
UPDATE PWC_E_COUNTRYREGION
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		COUNTRYREGION= '' or COUNTRYREGION is null

UPDATE PWC_E_COUNTRYREGION
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSFORMAT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		ADDRESSFORMAT= '' or ADDRESSFORMAT is null

UPDATE PWC_E_COUNTRYREGION 
	SET ERRORDESC = CONCAT(ERRORDESC,'NAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		NAME= '' or NAME is null

UPDATE PWC_E_COUNTRYREGION 
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		TIMEZONE= '' or TIMEZONE is null

UPDATE PWC_E_COUNTRYREGION
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGION,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		COUNTRYREGION IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(COUNTRYREGION,DATAAREAID) IN 
		(SELECT CONCAT(COUNTRYREGION,DATAAREAID) FROM PWC_E_COUNTRYREGION
		GROUP BY COUNTRYREGION,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_COUNTRYREGION
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGION
	WHERE 
		TIMEZONE IS NOT NULL AND TIMEZONE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'Timezone')


Country region translation-
UPDATE PWC_E_COUNTRYREGIONTRANSLATION
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION
	WHERE 
		COUNTRYREGIONID= '' or COUNTRYREGIONID is null

UPDATE PWC_E_COUNTRYREGIONTRANSLATION
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION
	WHERE 
		LANGUAGEID= '' or LANGUAGEID is null

UPDATE PWC_E_COUNTRYREGIONTRANSLATION
	SET ERRORDESC = CONCAT(ERRORDESC,'LONGNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION
	WHERE 
		LONGNAME= '' or LONGNAME is null

UPDATE PWC_E_COUNTRYREGIONTRANSLATION
	SET ERRORDESC = CONCAT(ERRORDESC,'SHORTNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION
	WHERE 
		SHORTNAME= '' or SHORTNAME is null

UPDATE PWC_E_COUNTRYREGIONTRANSLATION
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM  PWC_E_COUNTRYREGIONTRANSLATION
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(COUNTRYREGIONID,DATAAREAID) IN 
		(SELECT CONCAT(COUNTRYREGIONID,DATAAREAID) FROM PWC_E_COUNTRYREGIONTRANSLATION
		GROUP BY COUNTRYREGIONID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_COUNTRYREGIONTRANSLATION 
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is not there in COUNTRYREGION of Country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION A
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND COUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_COUNTRYREGIONTRANSLATION 
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID is not there in LanguageCodeId of Language','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COUNTRYREGIONTRANSLATION A
	WHERE 
		LANGUAGEID IS NOT NULL AND LANGUAGEID NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)


State-
UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_STATE
	WHERE 
		COUNTRYREGIONID= '' or COUNTRYREGIONID is null

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'STATE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_STATE
	WHERE 
		STATE= '' or STATE is null

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'NAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_STATE
	WHERE 
		NAME= '' or NAME is null

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_STATE
	WHERE 
		TIMEZONE= '' or TIMEZONE is null

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID,STATE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_STATE
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND DATAAREAID IS NOT NULL AND STATE IS NOT NULL AND CONCAT(COUNTRYREGIONID,DATAAREAID,STATE) IN 
		(SELECT CONCAT(COUNTRYREGIONID,DATAAREAID,STATE) FROM PWC_E_STATE
		GROUP BY COUNTRYREGIONID,DATAAREAID,STATE HAVING COUNT(*)>1)

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is not there in COUNTRYREGION of Country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_STATE A
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND COUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_STATE
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_STATE
	WHERE 
		TIMEZONE IS NOT NULL AND TIMEZONE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'Timezone')

City-
UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'CITYKEY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CITY
	WHERE 
		CITYKEY= '' or CITYKEY is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CITY
	WHERE 
		COUNTRYREGIONID= '' or COUNTRYREGIONID is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'NAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CITY
	WHERE 
		NAME= '' or NAME is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CITY
	WHERE 
		COUNTYID= '' or COUNTYID is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CITY
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'STATEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CITY
	WHERE 
		STATEID= '' or STATEID is null

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'CITYKEY has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CITY
	WHERE 
		CITYKEY IS NOT NULL AND CONCAT(CITYKEY,DATAAREAID) IN 
		(SELECT CONCAT(CITYKEY,DATAAREAID) FROM PWC_E_CITY
		GROUP BY CITYKEY,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is not there in COUNTRYREGION of Country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CITY A
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND COUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CITY
	SET ERRORDESC = CONCAT(ERRORDESC,'STATEID is not there in STATE of state','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CITY A
	WHERE 
		STATEID IS NOT NULL AND STATEID NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)

Zipcode-
UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'ZIPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		ZIPCODE= '' or ZIPCODE is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		COUNTRYREGIONID= '' or COUNTRYREGIONID is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'STATEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		STATEID= '' or STATEID is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		COUNTYID= '' or COUNTYID is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'CITYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		CITYID= '' or CITYID is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'DISTRICTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		DISTRICTID= '' or DISTRICTID is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		TIMEZONE= '' or TIMEZONE is null

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'ZIPCODE,COUNTRYREGIONID,STATEID,CITYID,DISTRICTID,TIMEZONE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ZIPCODE	
	WHERE 
		ZIPCODE IS NOT NULL AND COUNTRYREGIONID IS NOT NULL AND STATEID IS NOT NULL AND CITYID IS NOT NULL AND DISTRICTID IS NOT NULL AND TIMEZONE IS NOT NULL AND 
		CONCAT(ZIPCODE,COUNTRYREGIONID,STATEID,CITYID,DISTRICTID,TIMEZONE,DATAAREAID) IN 
		(SELECT CONCAT(ZIPCODE,COUNTRYREGIONID,STATEID,CITYID,DISTRICTID,TIMEZONE,DATAAREAID) FROM PWC_E_ZIPCODE
		GROUP BY ZIPCODE,COUNTRYREGIONID,STATEID,CITYID,DISTRICTID,TIMEZONE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'COUNTRYREGIONID is not there in COUNTRYREGION of Country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE A
	WHERE 
		COUNTRYREGIONID IS NOT NULL AND COUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'STATEID is not there in STATE of state','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE A
	WHERE 
		STATEID IS NOT NULL AND STATEID NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'CITYID is not there in NAME of City','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE A
	WHERE 
		CITYID IS NOT NULL AND CITYID NOT IN 
		(SELECT B.NAME FROM PWC_E_CITY B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_ZIPCODE
	SET ERRORDESC = CONCAT(ERRORDESC,'TIMEZONE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ZIPCODE
	WHERE 
		TIMEZONE IS NOT NULL AND TIMEZONE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'Timezone')


Item Master Utilities ERP Pilot Validation


---------------------------- Validation Rules--------------------------------



----> External Item Description

ItemNumber is not null --- Error --- 2
VendorAccountNumber is null --- Warning ---- 3
VendorProductNumber is null --- Warning ---- 3
VendorProductDescription is null --- Warning ---- 3

ItemNumber, VendorAccountNumber,DATAAREAID has duplicate values --- Constraint --- 1

ITEMNUMBER is not there in ITEMNUMBER of Released Products ---- Error --- 2
VendorAccountNumber is not there in VENDORACCOUNTNUMBER of Vendor Master ---- Error --- 2















------------------------- Validation Script --------------------------------------

---Released Products

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		ITEMNUMBER= '' or ITEMNUMBER is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		ITEMNUMBER IS NOT NULL AND CONCAT(ITEMNUMBER,DATAAREAID) IN 
		(SELECT CONCAT(ITEMNUMBER,DATAAREAID) FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
		GROUP BY ITEMNUMBER,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'APPROVEDVENDORCHECKMETHOD is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		APPROVEDVENDORCHECKMETHOD= '' or APPROVEDVENDORCHECKMETHOD is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'APPROVEDVENDORCHECKMETHOD has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE
		APPROVEDVENDORCHECKMETHOD IS NOT NULL AND APPROVEDVENDORCHECKMETHOD NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'PdsVendorCheckItem')

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BARCODESETUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		BARCODESETUPID= '' or BARCODESETUPID is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BARCODESETUPID is not in BARCODESETUPID of Barcode Setup','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		BARCODESETUPID IS NOT NULL AND BARCODESETUPID NOT IN 
		(SELECT B.BARCODESETUPID FROM PWC_E_BARCODESETUP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.BARCODESETUPID IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BASEPRICEPURCHASE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		BASEPRICEPURCHASE= '' or BASEPRICEPURCHASE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BATCHNUMBERGROUPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		BATCHNUMBERGROUPCODE= '' or BATCHNUMBERGROUPCODE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BESTBEFOREPERIODDAYS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		BESTBEFOREPERIODDAYS= '' or BESTBEFOREPERIODDAYS is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BOMUNITSYMBOL is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		BOMUNITSYMBOL= '' or BOMUNITSYMBOL is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BOMUNITSYMBOL is not in UnitSymbol of Units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		BOMUNITSYMBOL IS NOT NULL AND BOMUNITSYMBOL NOT IN 
		(SELECT B.UnitSymbol FROM PWC_E_UNIT B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.UnitSymbol IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'DEFAULTORDERTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		DEFAULTORDERTYPE= '' or DEFAULTORDERTYPE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'DEFAULTORDERTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE
		DEFAULTORDERTYPE IS NOT NULL AND DEFAULTORDERTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'ReqPOType')

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'INVENTORYUNITSYMBOL is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		INVENTORYUNITSYMBOL= '' or INVENTORYUNITSYMBOL is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'INVENTORYUNITSYMBOL is not in UnitSymbol of Units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		INVENTORYUNITSYMBOL IS NOT NULL AND INVENTORYUNITSYMBOL NOT IN 
		(SELECT B.UnitSymbol FROM PWC_E_UNIT B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.UnitSymbol IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPHANTOM is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		ISPHANTOM= '' or ISPHANTOM is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMMODELGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		ITEMMODELGROUPID= '' or ITEMMODELGROUPID is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMMODELGROUPID is not in POLICYID of Item model groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		ITEMMODELGROUPID IS NOT NULL AND ITEMMODELGROUPID NOT IN 
		(SELECT B.POLICYID FROM PWC_E_ITEMMODELGROUP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.POLICYID IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'NETPRODUCTWEIGHT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		NETPRODUCTWEIGHT= '' or NETPRODUCTWEIGHT is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTGROUPID= '' or PRODUCTGROUPID is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTGROUPID is not in GROUPID of Item Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		PRODUCTGROUPID IS NOT NULL AND PRODUCTGROUPID NOT IN 
		(SELECT B.GROUPID FROM PWC_E_ITEMGROUPS B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPID IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTIONTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTIONTYPE= '' or PRODUCTIONTYPE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTIONTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE
		PRODUCTIONTYPE IS NOT NULL AND PRODUCTIONTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'PmfProductType')

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTLIFECYCLESTATEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTLIFECYCLESTATEID= '' or PRODUCTLIFECYCLESTATEID is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTLIFECYCLESTATEID is not in LIFECYCLESTATEID of Product Lifecycle state','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		PRODUCTLIFECYCLESTATEID IS NOT NULL AND PRODUCTLIFECYCLESTATEID NOT IN 
		(SELECT B.LIFECYCLESTATEID FROM PWC_E_PRODLIFECYCLESTATE B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LIFECYCLESTATEID IS NOT NULL)


UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTNUMBER= '' or PRODUCTNUMBER is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTNUMBER is not there in PRODUCTNUMBER of Products V2','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A
	WHERE 
		PRODUCTNUMBER IS NOT NULL AND PRODUCTNUMBER NOT IN 
		(SELECT B.PRODUCTNUMBER FROM PWC_E_ECORESPRODUCTV2STAGING B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.PRODUCTNUMBER IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTSUBTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTSUBTYPE= '' or PRODUCTSUBTYPE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTSUBTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE
		PRODUCTSUBTYPE IS NOT NULL AND PRODUCTSUBTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'EcoResProductSubtype')

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		PRODUCTTYPE= '' or PRODUCTTYPE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE
		PRODUCTTYPE IS NOT NULL AND PRODUCTTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'EcoResProductType')

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PURCHASEPRICE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		PURCHASEPRICE= '' or PURCHASEPRICE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PURCHASEUNITSYMBOL is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		PURCHASEUNITSYMBOL= '' or PURCHASEUNITSYMBOL is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PURCHASEUNITSYMBOL is not in UnitSymbol of Units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		PURCHASEUNITSYMBOL IS NOT NULL AND PURCHASEUNITSYMBOL NOT IN 
		(SELECT B.UnitSymbol FROM PWC_E_UNIT B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.UnitSymbol IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESPRICE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		SALESPRICE= '' or SALESPRICE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSALESTAXITEMGROUPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING	
	WHERE 
		SALESSALESTAXITEMGROUPCODE= '' or SALESSALESTAXITEMGROUPCODE is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSALESTAXITEMGROUPCODE is not in ITEMSALESTAXGROUP of Item Sales Tax Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		SALESSALESTAXITEMGROUPCODE IS NOT NULL AND PURCHASEUNITSYMBOL NOT IN 
		(SELECT B.ITEMSALESTAXGROUP FROM PWC_E_ITEMSALESTAXGROUP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.ITEMSALESTAXGROUP IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESUNITSYMBOL is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		SALESUNITSYMBOL= '' or SALESUNITSYMBOL is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESUNITSYMBOL is not in UnitSymbol of Units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		SALESUNITSYMBOL IS NOT NULL AND SALESUNITSYMBOL NOT IN 
		(SELECT B.UnitSymbol FROM PWC_E_UNIT B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.UnitSymbol IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SEARCHNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		SEARCHNAME= '' or SEARCHNAME is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SHELFADVICEPERIODDAYS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		SHELFADVICEPERIODDAYS= '' or SHELFADVICEPERIODDAYS is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SHELFLIFEPERIODDAYS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		SHELFLIFEPERIODDAYS= '' or SHELFLIFEPERIODDAYS is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'STORAGEDIMENSIONGROUPNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		STORAGEDIMENSIONGROUPNAME= '' or STORAGEDIMENSIONGROUPNAME is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'STORAGEDIMENSIONGROUPNAME is not in GROUPNAME of Storage Dimension Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		STORAGEDIMENSIONGROUPNAME IS NOT NULL AND STORAGEDIMENSIONGROUPNAME NOT IN 
		(SELECT B.GROUPNAME FROM PWC_E_STORAGEDIMGRP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPNAME IS NOT NULL)

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'TRACKINGDIMENSIONGROUPNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		TRACKINGDIMENSIONGROUPNAME= '' or TRACKINGDIMENSIONGROUPNAME is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'TRACKINGDIMENSIONGROUPNAME is not in GROUPNAME of Tracking Dimension Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING A	
	WHERE 
		TRACKINGDIMENSIONGROUPNAME IS NOT NULL AND TRACKINGDIMENSIONGROUPNAME NOT IN 
		(SELECT B.GROUPNAME FROM PWC_E_TRACKINGDIMGRP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPNAME IS NOT NULL)



UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'LegacyItemCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		LegacyItemCode= '' or LegacyItemCode is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ArabicDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		ArabicDescription= '' or ArabicDescription is null

UPDATE PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ProductDesignCreationDate is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING
	WHERE 
		ProductDesignCreationDate= '' or ProductDesignCreationDate is null

















-------------Products V2

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTNUMBER= '' or PRODUCTNUMBER is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTNUMBER,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTNUMBER IS NOT NULL AND CONCAT(PRODUCTNUMBER,DATAAREAID) IN 
		(SELECT CONCAT(PRODUCTNUMBER,DATAAREAID) FROM PWC_E_ECORESPRODUCTV2STAGING
		GROUP BY PRODUCTNUMBER,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTDESCRIPTION= '' or PRODUCTDESCRIPTION is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTNAME= '' or PRODUCTNAME is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTSEARCHNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTSEARCHNAME= '' or PRODUCTSEARCHNAME is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTSUBTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTSUBTYPE= '' or PRODUCTSUBTYPE is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTSUBTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ ECORESPRODUCTV2STAGING	
	WHERE
		PRODUCTSUBTYPE IS NOT NULL AND PRODUCTSUBTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'EcoResProductSubtype')

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		PRODUCTTYPE= '' or PRODUCTTYPE is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PRODUCTTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ ECORESPRODUCTV2STAGING	
	WHERE
		PRODUCTTYPE IS NOT NULL AND PRODUCTTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'EcoResProductType')

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'STORAGEDIMENSIONGROUPNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		STORAGEDIMENSIONGROUPNAME= '' or STORAGEDIMENSIONGROUPNAME is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'STORAGEDIMENSIONGROUPNAME is not there in GROUPNAME of Storage Dimension Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING A	
	WHERE 
		STORAGEDIMENSIONGROUPNAME IS NOT NULL AND STORAGEDIMENSIONGROUPNAME NOT IN 
		(SELECT B.GROUPNAME FROM PWC_E_STORAGEDIMGRP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPNAME IS NOT NULL)

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'TRACKINGDIMENSIONGROUPNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		TRACKINGDIMENSIONGROUPNAME= '' or TRACKINGDIMENSIONGROUPNAME is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'TRACKINGDIMENSIONGROUPNAME is not there in GROUPNAME of Tracking Dimension Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING A	
	WHERE 
		TRACKINGDIMENSIONGROUPNAME IS NOT NULL AND TRACKINGDIMENSIONGROUPNAME NOT IN 
		(SELECT B.GROUPNAME FROM PWC_E_TRACKINGDIMGRP B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPNAME IS NOT NULL)

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'LegacyItemCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		LegacyItemCode= '' or LegacyItemCode is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ArabicDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		ArabicDescription= '' or ArabicDescription is null

UPDATE PWC_E_ECORESPRODUCTV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ProductDesignCreationDate is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ECORESPRODUCTV2STAGING	
	WHERE 
		ProductDesignCreationDate= '' or ProductDesignCreationDate is null

























----> External Item Description

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'ItemNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EXTITEMDESC
	WHERE 
		ItemType= '' or ItemType is null

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'VendorAccountNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EXTITEMDESC
	WHERE 
		VendorAccountNumber= '' or VendorAccountNumber is null

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'VendorProductNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EXTITEMDESC
	WHERE 
		VendorProductNumber= '' or VendorProductNumber is null

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'VendorProductDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EXTITEMDESC
	WHERE 
		VendorProductDescription= '' or VendorProductDescription is null

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'ItemNumber, VendorAccountNumber,DATAAREAID has duplicates','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_EXTITEMDESC 
	WHERE 
		ITEMNUMBER IS NOT NULL AND 
		VendorAccountNumber IS NOT NULL AND 
		CONCAT(ItemNumber, VendorAccountNumber,DATAAREAID) IN 
		(SELECT CONCAT(ItemNumber, VendorAccountNumber,DATAAREAID) FROM PWC_E_EXTITEMDESC
		GROUP BY ItemNumber, VendorAccountNumber,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER not in Released Products','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EXTITEMDESC A
	WHERE 
		ITEMNUMBER IS NOT NULL AND ITEMNUMBER NOT IN
		(SELECT B.ITEMNUMBER FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.ITEMNUMBER IS NOT NULL)

UPDATE PWC_E_EXTITEMDESC
	SET ERRORDESC = CONCAT(ERRORDESC,'VendorAccountNumber not in VENDORACCOUNTNUMBER of Vendor Master','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EXTITEMDESC A
	WHERE 
		VendorAccountNumber IS NOT NULL AND VendorAccountNumber NOT IN 
		(SELECT B.VENDORACCOUNTNUMBER FROM PWC_E_VENDOR B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.VENDORACCOUNTNUMBER IS NOT NULL)

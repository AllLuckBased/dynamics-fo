Site Warehouse Location ERP Pilot Validation script

------------------------------------Validation Rules----------------------------------------



--->Warehouse locations

WAREHOUSEID is blank --- Error --- 2
WAREHOUSEAISLEID is blank --- Warning --- 3
WAREHOUSELOCATIONID is blank --- Warning --- 3
WAREHOUSELOCATIONTYPE is blank --- Warning --- 3
WAREHOUSEZONEID is blank --- Warning --- 3
ISDEFAULTISSUEWAREHOUSELOCATION is blank --- Warning --- 3
ISDEFAULTRECEIPTWAREHOUSELOCATION is blank --- Warning --- 3
LOCATIONSTATUS is blank --- Warning --- 3

WAREHOUSEID,WAREHOUSELOCATIONID,DATAAREAID has duplicate values --- Constraint --- 1

WAREHOUSELOCATIONTYPE enum has invalid enum values --- Error --- 2

LOCATIONSTATUS enum has invalid enum values --- Error --- 2
WAREHOUSEID is not there in WAREHOUSEID of warehouses --- Error --- 2








--------------------------ERP Pilot Vaidation---------------------



----------> Sites

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPRIMARYADDRESSASSIGNED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SITEERP	
	WHERE 
		ISPRIMARYADDRESSASSIGNED= '' or ISPRIMARYADDRESSASSIGNED is null 
		AND (PRIMARYADDRESSSTREET IS NOT NULL OR PRIMARYADDRESSDESCRIPTION IS NOT NULL)

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'SiteId is blank','; ')
	,ERRORSTATUS = ERRORSTATUS
	FROM PWC_E_SITEERP 
	WHERE 
		SiteId= '' or SiteId is null

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'SiteName is blank','; ')
	,ERRORSTATUS = ERRORSTATUS
	FROM PWC_E_SITEERP 
	WHERE 
		SiteName= '' or SiteName is null

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'SiteId and DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = ERRORSTATUS
	FROM PWC_E_SITEERP 
	WHERE 
		SiteId IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(SiteId,DATAAREAID) IN 
		(SELECT CONCAT(SiteId,DATAAREAID) FROM PWC_E_SITEERP
		GROUP BY SiteId,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'DEFAULTFINANCIALDIMENSIONVALUE and DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = ERRORSTATUS
	FROM PWC_E_SITEERP 
	WHERE 
		DEFAULTFINANCIALDIMENSIONVALUE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(DEFAULTFINANCIALDIMENSIONVALUE,DATAAREAID) IN 
		(SELECT CONCAT(DEFAULTFINANCIALDIMENSIONVALUE,DATAAREAID) FROM PWC_E_SITEERP
		GROUP BY DEFAULTFINANCIALDIMENSIONVALUE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'DEFAULTFINANCIALDIMENSIONVALUE is not there in DIMENSIONVALUE of Operating Unit Financial Dimension','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SITEERP
	WHERE DEFAULTFINANCIALDIMENSIONVALUE is not null and DEFAULTFINANCIALDIMENSIONVALUE not in
	(select DIMENSIONVALUE from PWC_E_FINDIMVALUES WHERE FINANCIALDIMENSION LIKE 'Operating%')

UPDATE PWC_E_SITEERP
	SET ERRORDESC = CONCAT(ERRORDESC, 'PRIMARYADDRESSCOUNTRYREGIONID, PRIMARYADDRESSCITY, PRIMARYADDRESSSTATEID is not matching with the Address master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_SITEERP 
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID IS NOT NULL AND
		PRIMARYADDRESSCITY IS NOT NULL AND
		PRIMARYADDRESSSTATEID IS NOT NULL AND CONCAT(PRIMARYADDRESSCOUNTRYREGIONID, PRIMARYADDRESSCITY, PRIMARYADDRESSSTATEID ) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME, B.STATE ) FROM PWC_E_CITY B)

















-----> Warehouses

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'GOODSINTRANSITWAREHOUSEID should be blank if WAREHOUSETYPE is not Default','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		GOODSINTRANSITWAREHOUSEID is not null and (WAREHOUSETYPE IS NOT NULL AND WAREHOUSETYPE NOT LIKE '%STAND%')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'QUARANTINEWAREHOUSEID should be blank if WAREHOUSETYPE is not Default','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		QUARANTINEWAREHOUSEID is not null and (WAREHOUSETYPE IS NOT NULL AND WAREHOUSETYPE NOT LIKE '%STAND%')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		WAREHOUSEID= '' or WAREHOUSEID is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATIONALSITEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		OPERATIONALSITEID= '' or OPERATIONALSITEID is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCWAREHOUSEMATERIALTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PWCWAREHOUSEMATERIALTYPE= '' or PWCWAREHOUSEMATERIALTYPE is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSETYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		WAREHOUSETYPE= '' or WAREHOUSETYPE is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSENAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		WAREHOUSENAME= '' or WAREHOUSENAME is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'ISFINANCIALNEGATIVERETAILSTOREINVENTORYALLOWED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		ISFINANCIALNEGATIVERETAILSTOREINVENTORYALLOWED= '' or ISFINANCIALNEGATIVERETAILSTOREINVENTORYALLOWED is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPHYSICALNEGATIVERETAILSTOREINVENTORYALLOWED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		ISPHYSICALNEGATIVERETAILSTOREINVENTORYALLOWED= '' or ISPHYSICALNEGATIVERETAILSTOREINVENTORYALLOWED is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCITY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSCITY= '' or PRIMARYADDRESSCITY is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID= '' or PRIMARYADDRESSCOUNTRYREGIONID is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSSTATEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSSTATEID= '' or PRIMARYADDRESSSTATEID is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSSTREET is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSSTREET= '' or PRIMARYADDRESSSTREET is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPRIMARYADDRESSASSIGNED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		ISPRIMARYADDRESSASSIGNED= '' or ISPRIMARYADDRESSASSIGNED is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSLOCATIONROLES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSLOCATIONROLES= '' or PRIMARYADDRESSLOCATIONROLES is null

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PRIMARYADDRESSDESCRIPTION= '' or PRIMARYADDRESSDESCRIPTION is null










UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC, 'PRIMARYADDRESSCOUNTRYREGIONID, PRIMARYADDRESSCITY, PRIMARYADDRESSSTATEID is not matching with the Address master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_WAREHOUSEERP 
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID IS NOT NULL AND
		PRIMARYADDRESSCITY IS NOT NULL AND
		PRIMARYADDRESSSTATEID IS NOT NULL AND CONCAT(PRIMARYADDRESSCOUNTRYREGIONID, PRIMARYADDRESSCITY, PRIMARYADDRESSSTATEID ) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME, B.STATEID ) FROM PWC_E_CITY B)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		WAREHOUSEID IS NOT NULL AND CONCAT(WAREHOUSEID,DATAAREAID) IN
		(SELECT CONCAT(WAREHOUSEID,DATAAREAID) FROM PWC_E_WAREHOUSEERP
		GROUP BY WAREHOUSEID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'QUARANTINEWAREHOUSEID is not there in WAREHOUSEID of Warehouses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		QUARANTINEWAREHOUSEID IS NOT NULL AND QUARANTINEWAREHOUSEID NOT IN 
		(SELECT B.WAREHOUSEID FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL AND B.WAREHOUSETYPE LIKE 'Q%')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSETYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		WAREHOUSETYPE IS NOT NULL AND WAREHOUSETYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'InventLocationType')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCWAREHOUSEMATERIALTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	
	WHERE 
		PWCWAREHOUSEMATERIALTYPE IS NOT NULL AND PWCWAREHOUSEMATERIALTYPE NOT IN ('Default', 'RM', 'PM', 'FG', 'VanSell')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATIONALSITEID is not there in SITEID of Sites','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		OPERATIONALSITEID IS NOT NULL AND OPERATIONALSITEID NOT IN 
		(SELECT B.SITEID FROM PWC_E_SITEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.SITEID IS NOT NULL)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCITY is not there in NAME of City','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE
		PRIMARYADDRESSCITY IS NOT NULL AND PRIMARYADDRESSCITY NOT IN 
		(SELECT B.NAME FROM PWC_E_CITY B)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONID is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID IS NOT NULL AND PRIMARYADDRESSCOUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSSTATEID is not there in STATE of State','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		PRIMARYADDRESSSTATEID IS NOT NULL AND PRIMARYADDRESSSTATEID NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'GOODSINTRANSITWAREHOUSEID is not there in WAREHOUSEID of Warehouses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		GOODSINTRANSITWAREHOUSEID IS NOT NULL AND GOODSINTRANSITWAREHOUSEID NOT IN 
		(SELECT B.WAREHOUSEID FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL AND B.WAREHOUSETYPE LIKE 'T%')

UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'AREADVANCEDWAREHOUSEMANAGEMENTPROCESSESENABLED cannot be YES for Quarantine and Transit Type Warehouses ','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		AREADVANCEDWAREHOUSEMANAGEMENTPROCESSESENABLED IS NOT NULL AND AREADVANCEDWAREHOUSEMANAGEMENTPROCESSESENABLED LIKE '%Y%' AND (WAREHOUSETYPE LIKE 'QUA%' OR WAREHOUSETYPE LIKE 'TRANS%')


UPDATE PWC_E_WAREHOUSEERP
	SET ERRORDESC = CONCAT(ERRORDESC,'QUARANTINEWAREHOUSEID,OPERATIONALSITEID is not matching Warehouse Master','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSEERP	A
	WHERE 
		QUARANTINEWAREHOUSEID IS NOT NULL AND
		OPERATIONALSITEID IS NOT NULL AND
		CONCAT(QUARANTINEWAREHOUSEID,OPERATIONALSITEID) NOT IN 
		(SELECT CONCAT(B.WAREHOUSEID, B.OPERATIONALSITEID) FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL AND B.WAREHOUSETYPE LIKE 'Q%')























----------- Warehouse Locations

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS
	WHERE 
		WAREHOUSEID= '' or WAREHOUSEID is null

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONPROFILEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS
	WHERE 
		WAREHOUSELOCATIONPROFILEID= '' or WAREHOUSELOCATIONPROFILEID is null

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS
	WHERE 
		WAREHOUSELOCATIONID= '' or WAREHOUSELOCATIONID is null



UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'ISDEFAULTISSUEWAREHOUSELOCATION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS
	WHERE 
		ISDEFAULTISSUEWAREHOUSELOCATION= '' or ISDEFAULTISSUEWAREHOUSELOCATION is null

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'ISDEFAULTRECEIPTWAREHOUSELOCATION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS
	WHERE 
		ISDEFAULTRECEIPTWAREHOUSELOCATION= '' or ISDEFAULTRECEIPTWAREHOUSELOCATION is null

UPDATE PWC_E_WAREHOUSELOCATIONS
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID,WAREHOUSELOCATIONID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS	
	WHERE 
		WAREHOUSEID IS NOT NULL AND WAREHOUSELOCATIONID IS NOT NULL AND 
		CONCAT(WAREHOUSEID,WAREHOUSELOCATIONID,DATAAREAID) IN 
		(SELECT CONCAT(WAREHOUSEID,WAREHOUSELOCATIONID,DATAAREAID) FROM PWC_E_WAREHOUSELOCATIONS
		GROUP BY WAREHOUSEID,WAREHOUSELOCATIONID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID is not there in WAREHOUSEID of warehouses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS A
	WHERE 
		WAREHOUSEID IS NOT NULL AND WAREHOUSEID NOT IN 
		(SELECT B.WAREHOUSEID FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL)

UPDATE PWC_E_WAREHOUSELOCATIONS 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONPROFILEID is not there in PROFILEID of warehouse location profiles','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONS A
	WHERE 
		WAREHOUSELOCATIONPROFILEID IS NOT NULL AND WAREHOUSELOCATIONPROFILEID IN 
		(SELECT B.PROFILEID FROM PWC_E_WAREHOUSELOCATIONPROFILE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL)

    ----------- Warehouse Locations which will be setup by sankalp in "Inventory Management -> Setup -> Inventory breakdown -> Inventory Locations"

	SELECT *
	FROM PWC_E_WAREHOUSELOCATIONS A
	WHERE 
		WAREHOUSEID IS NOT NULL AND WAREHOUSEID IN 
		(SELECT B.WAREHOUSEID FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL AND B.AREADVANCEDWAREHOUSEMANAGEMENTPROCESSESENABLED LIKE '%N%')





















-----> Warehouse Location Profiles

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISLOCATIONALLOWINGMIXEDITEMBATCHES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		ISLOCATIONALLOWINGMIXEDITEMBATCHES= '' or ISLOCATIONALLOWINGMIXEDITEMBATCHES is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISLOCATIONALLOWINGMIXEDITEMS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		ISLOCATIONALLOWINGMIXEDITEMS= '' or ISLOCATIONALLOWINGMIXEDITEMS is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISLOCATIONALLOWINGMIXEDITEMSTATUSES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		ISLOCATIONALLOWINGMIXEDITEMSTATUSES= '' or ISLOCATIONALLOWINGMIXEDITEMSTATUSES is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISLOCATIONALLOWINGNEGATIVEINVENTORY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		ISLOCATIONALLOWINGNEGATIVEINVENTORY= '' or ISLOCATIONALLOWINGNEGATIVEINVENTORY is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'ISLOCATIONALLOWINGCYCLECOUNTING is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		ISLOCATIONALLOWINGCYCLECOUNTING= '' or ISLOCATIONALLOWINGCYCLECOUNTING is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONFORMATID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		WAREHOUSELOCATIONFORMATID= '' or WAREHOUSELOCATIONFORMATID is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'PROFILEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		PROFILEID= '' or PROFILEID is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'PROFILEID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		PROFILEID IS NOT NULL AND CONCAT(PROFILEID,DATAAREAID) IN 
		(SELECT CONCAT(PROFILEID,DATAAREAID) FROM PWC_E_WAREHOUSELOCATIONPROFILE
		GROUP BY PROFILEID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'PROFILENAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		PROFILENAME= '' or PROFILENAME is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONTYPEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		WAREHOUSELOCATIONTYPEID= '' or WAREHOUSELOCATIONTYPEID is null

UPDATE PWC_E_WAREHOUSELOCATIONPROFILE
	SET ERRORDESC = CONCAT(ERRORDESC,'USELICENSEPLATETRACKING is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSELOCATIONPROFILE	
	WHERE 
		USELICENSEPLATETRACKING= '' or USELICENSEPLATETRACKING is null


















------------- Warehouse Stocking Limits

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'QUANTITYLIMIT is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		QUANTITYLIMIT LIKE '%[^0-9.]%'

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT 
	SET ERRORDESC = CONCAT(ERRORDESC,'ISUNLIMITEDQUANTITYALLOWED has wrong BOOLEAN FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		LOWER( ISUNLIMITEDQUANTITYALLOWED ) NOT IN ('no', 'yes')

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'WAREHOUSESELECTION is not "Warehouse"','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		UPPER(WAREHOUSESELECTION) LIKE 'WAREHOUSE'



UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		WAREHOUSEID= '' or WAREHOUSEID is null

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		WAREHOUSELOCATIONID= '' or WAREHOUSELOCATIONID is null

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONPROFILEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		WAREHOUSELOCATIONPROFILEID= '' or WAREHOUSELOCATIONPROFILEID is null

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		ITEMNUMBER= '' or ITEMNUMBER is null

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSESELECTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		WAREHOUSESELECTION= '' or WAREHOUSESELECTION is null

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'ISUNLIMITEDQUANTITYALLOWED is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		ISUNLIMITEDQUANTITYALLOWED= '' or ISUNLIMITEDQUANTITYALLOWED is null



UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'QUANTITYLIMIT is blank when ISUNLIMITEDQUANTITYALLOWED is neither blank nor "No"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		(QUANTITYLIMIT= '' or QUANTITYLIMIT is null) AND (ISUNLIMITEDQUANTITYALLOWED IS NOT NULL OR UPPER(ISUNLIMITEDQUANTITYALLOWED) NOT LIKE 'NO')

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'QUANTITYLIMIT is NOT blank when ISUNLIMITEDQUANTITYALLOWED is "Yes"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		QUANTITYLIMIT is NOT null AND UPPER(ISUNLIMITEDQUANTITYALLOWED) NOT LIKE 'YES'

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'QUANTITYLIMITUNITSYMBOL is blank when ISUNLIMITEDQUANTITYALLOWED is neither blank nor "No"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		(QUANTITYLIMITUNITSYMBOL= '' or QUANTITYLIMITUNITSYMBOL is null) AND (ISUNLIMITEDQUANTITYALLOWED IS NOT NULL OR UPPER(ISUNLIMITEDQUANTITYALLOWED) NOT LIKE 'NO')

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'QUANTITYLIMITUNITSYMBOL is NOT blank when ISUNLIMITEDQUANTITYALLOWED is "Yes"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		QUANTITYLIMITUNITSYMBOL is NOT null AND UPPER(ISUNLIMITEDQUANTITYALLOWED) NOT LIKE 'YES'


UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID,WAREHOUSELOCATIONID,WAREHOUSELOCATIONPROFILEID,ITEMNUMBER,QUANTITYLIMITUNITSYMBOL,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	
	WHERE 
		CONCAT(WAREHOUSEID,WAREHOUSELOCATIONID,WAREHOUSELOCATIONPROFILEID,ITEMNUMBER,QUANTITYLIMITUNITSYMBOL,DATAAREAID) IN 
		(SELECT CONCAT(WAREHOUSEID,WAREHOUSELOCATIONID,WAREHOUSELOCATIONPROFILEID,ITEMNUMBER,QUANTITYLIMITUNITSYMBOL,DATAAREAID) FROM PWC_E_WAREHOUSELOCATIONS
		GROUP BY WAREHOUSEID,WAREHOUSELOCATIONID,WAREHOUSELOCATIONPROFILEID,ITEMNUMBER,QUANTITYLIMITUNITSYMBOL,DATAAREAID HAVING COUNT(*)>1)




UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'QUANTITYLIMITUNITSYMBOL is not in UnitSymbol of Units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A	
	WHERE 
		QUANTITYLIMITUNITSYMBOL IS NOT NULL AND QUANTITYLIMITUNITSYMBOL NOT IN 
		(SELECT B.QUANTITYLIMITUNITSYMBOL FROM PWC_E_UNIT B WHERE B.DATAAREAID = A.DATAAREAID)

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER not in Released Products','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		ITEMNUMBER IS NOT NULL AND ITEMNUMBER NOT IN
		(SELECT B.ITEMNUMBER FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.ITEMNUMBER IS NOT NULL)

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID is not there in WAREHOUSEID of Warehouses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT	A
	WHERE 
		WAREHOUSEID IS NOT NULL AND WAREHOUSEID NOT IN 
		(SELECT B.WAREHOUSEID FROM PWC_E_WAREHOUSEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL)

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONPROFILEID is not there in PROFILEID of warehouse location profiles','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		WAREHOUSELOCATIONPROFILEID IS NOT NULL AND WAREHOUSELOCATIONPROFILEID IN 
		(SELECT B.PROFILEID FROM PWC_E_WAREHOUSELOCATIONPROFILE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSEID IS NOT NULL)

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONID is not there in WAREHOUSELOCATIONID of warehouse location profiles','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		WAREHOUSELOCATIONID IS NOT NULL AND WAREHOUSELOCATIONID IN 
		(SELECT B.WAREHOUSELOCATIONID FROM PWC_E_WAREHOUSELOCATIONS B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.WAREHOUSELOCATIONID IS NOT NULL)

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSEID, WAREHOUSELOCATIONID is not matching with WAREHOUSEID, WAREHOUSELOCATIONID of Warehouse locations data','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		WAREHOUSELOCATIONID IS NOT NULL AND WAREHOUSEID IS NOT NULL AND CONCAT(WAREHOUSEID, WAREHOUSELOCATIONID) IN 
		(SELECT CONCAT(B.WAREHOUSEID, B.WAREHOUSELOCATIONID) FROM PWC_E_WAREHOUSELOCATIONS B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL'))

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT 
	SET ERRORDESC = CONCAT(ERRORDESC,'WAREHOUSELOCATIONPROFILEID, WAREHOUSELOCATIONID is not matching with WAREHOUSELOCATIONPROFILEID, WAREHOUSELOCATIONID of Warehouse locations data','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		WAREHOUSELOCATIONID IS NOT NULL AND WAREHOUSELOCATIONPROFILEID IS NOT NULL AND CONCAT(WAREHOUSELOCATIONPROFILEID, WAREHOUSELOCATIONID) IN 
		(SELECT CONCAT(B.WAREHOUSELOCATIONPROFILEID, B.WAREHOUSELOCATIONID) FROM PWC_E_WAREHOUSELOCATIONS B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL'))

UPDATE PWC_E_WAREHOUSESTOCKINGLIMIT
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER, QUANTITYLIMITUNITSYMBOL not matching with ITEMNUMBER, INVENTORYUNITSYMBOL of Released Products','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_WAREHOUSESTOCKINGLIMIT A
	WHERE 
		ITEMNUMBER IS NOT NULL AND QUANTITYLIMITUNITSYMBOL IS NOT NULL AND CONCAT(ITEMNUMBER,QUANTITYLIMITUNITSYMBOL) NOT IN
		(SELECT (B.ITEMNUMBER, B.INVENTORYUNITSYMBOL) FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.ITEMNUMBER IS NOT NULL)

































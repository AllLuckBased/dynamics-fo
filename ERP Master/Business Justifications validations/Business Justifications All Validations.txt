Business Justifications All Validations

-----------------------------------------------------------Validation Rules--------------------------------------------------------------------

PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE is blank --- Error --- 2
JUSTIFICATIONDESCRIPTION is blank --- Error --- 2

PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE ,DATAAREAID has duplicate values --- Constraint --- 1

PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE exceeds 10 characters --- Constraint --- 1
JUSTIFICATIONDESCRIPTION exceeds 255 characters --- Constraint --- 1






-----------------------------------------------------------Validation Script-------------------------------------------------------

UPDATE PWC_E_BIZJUSTIFY
	SET ERRORDESC = CONCAT(ERRORDESC,'PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_BIZJUSTIFY	
	WHERE 
		PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE= '' or PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE is null

UPDATE PWC_E_BIZJUSTIFY
	SET ERRORDESC = CONCAT(ERRORDESC,'JUSTIFICATIONDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_BIZJUSTIFY	
	WHERE 
		JUSTIFICATIONDESCRIPTION= '' or JUSTIFICATIONDESCRIPTION is null

UPDATE PWC_E_BIZJUSTIFY
	SET ERRORDESC = CONCAT(ERRORDESC,'PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_BIZJUSTIFY	
	WHERE 
		PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE IS NOT NULL AND CONCAT(PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE,DATAAREAID) IN
		(SELECT CONCAT(PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE,DATAAREAID) FROM PWC_E_BIZJUSTIFY
		GROUP BY PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_BIZJUSTIFY
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE exceeds max length 10','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_BIZJUSTIFY	
	WHERE LEN(PURCHASEREQUISITIONBUSINESSJUSTIFICATIONCODE) > 10 

UPDATE PWC_E_BIZJUSTIFY
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'JUSTIFICATIONDESCRIPTION exceeds max length 255','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_BIZJUSTIFY	
	WHERE LEN(JUSTIFICATIONDESCRIPTION) > 255 













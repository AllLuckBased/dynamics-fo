Customer ERP Pilot Validation Script



--->Customer Bank Accounts

CUSTOMERACCOUNTNUMBER is blank --- Error --- 2
BANKACCOUNTID is blank --- Error --- 2
BANKACCOUNTNUMBER is blank --- Warning --- 3
BANKNAME is blank --- Warning --- 3
ROUTINGNUMBER is blank --- Warning --- 3
ROUTINGNUMBERTYPE is blank --- Warning --- 3
CURRENCYCODE is blank --- Warning --- 3
IBAN is blank --- Warning --- 3
SWIFTCODE is blank --- Warning --- 3
CONTACTPERSONNAME is blank --- Warning --- 3
ISDEFAULTBANKACCOUNT is blank --- Warning --- 3

CUSTOMERACCOUNTNUMBER,BANKACCOUNTID,DATAAREAID has duplicate values --- Constraint ---- 1

CUSTOMERACCOUNTNUMBER is not there in CUSTOMERACCOUNT of Customer --- Error --- 2
CURRENCYCODE is not there in CURRENCYCODE of Currencies --- Error --- 2

BankCodeType
ROUTINGNUMBERTYPE enum has invalid enum values --- Error --- 2







----> Customer Postal Addresses

CUSTOMERACCOUNTNUMBER is null --- Error --- 2
CUSTOMERLEGALENTITYID is null --- Error --- 2
ADDRESSLOCATIONROLES is null --- Warning --- 3
ADDRESSCITY is null --- Warning --- 3
ADDRESSCOUNTRYREGIONID is null --- Warning --- 3
ADDRESSDESCRIPTION is null --- Warning --- 3
ADDRESSLATITUDE is null --- Warning --- 3
ADDRESSLONGITUDE is null --- Warning --- 3
ADDRESSPOSTBOX is null --- Warning --- 3
ADDRESSSTATE is null --- Warning --- 3
ADDRESSSTREET is null --- Warning --- 3
ADDRESSZIPCODE is null --- Warning --- 3
ISPRIMARY is null --- Warning --- 3
ISROLEBUSINESS is null --- Warning --- 3
ISROLEDELIVERY is null --- Warning --- 3
ISROLEINVOICE is null --- Warning --- 3

CUSTOMERACCOUNTNUMBER,CUSTOMERLEGALENTITYID,DATAAREAID has duplicate values --- Constraint --- 1

CUSTOMERACCOUNTNUMBER is not there in CUSTOMERACCOUNT of Customer --- Error --- 2
CUSTOMERLEGALENTITYID is not there in LEGALENTITYID of legal entities
ADDRESSCITY is not there in NAME of City --- Error --- 2
ADDRESSCOUNTRYREGIONID is not there in COUNTRYREGION of country --- Error --- 2
ADDRESSSTATE is not there in STATE of State --- Error --- 2
ADDRESSZIPCODE is not there in ZIPCODE of Zipcodes --- Error --- 2







------> Customer Contacts V2

CONTACTPERSONNAME is null --- Warning --- 3
CONTACTINFORMATIONLANGUAGEID is null --- Warning --- 3
PRIMARYADDRESSCITY is null --- Warning --- 3
PRIMARYADDRESSCOUNTRYREGIONID is null --- Warning --- 3
PRIMARYADDRESSCOUNTRYREGIONISOCODE is null --- Warning --- 3
PRIMARYADDRESSSTATEID is null --- Warning --- 3
PRIMARYEMAILADDRESS is null --- Warning --- 3
PRIMARYPHONENUMBER is null --- Warning --- 3

CONTACTINFORMATIONLANGUAGEID is not there in LanguageCodeId of Language Codes --- Error --- 1
PRIMARYADDRESSCITY is not there in NAME of City --- Error --- 1
PRIMARYADDRESSCOUNTRYREGIONID is not there in COUNTRYREGION of country --- Error --- 1
PRIMARYADDRESSCOUNTRYREGIONISOCODE is not there be in ISOCODE of country --- Error --- 1
PRIMARYADDRESSSTATEID is not there in STATE of State --- Error --- 1





--------> Customer Payment Method

Name is null --- Error --- 2
PaymentAccountDisplayValue is null --- Warning --- 3
AccountType is null --- Warning --- 3
BankTransactionType is null --- Warning --- 3
ExportBillOfExchangeDuringInvoicePosting is null --- Warning --- 3
BridgingPostingEnabled is null --- Warning --- 3
Description is null --- Warning --- 3
PaymentType is null --- Warning --- 3
PaymentJournalName is null --- Warning --- 3
CreateAndDrawBillOfExchangeDuringInvoicePosting is null --- Warning --- 3
PaymentStatus is null --- Warning --- 3
SumByPeriod is null --- Warning --- 3
EnablePostdatedCheckClearingPosting is null --- Warning --- 3
BillOfExchangeDraftType is null --- Warning --- 3

Name,DATAAREAID has duplicate values --- Constraint --- 1

LedgerJournalACType
AccountType has invalid enum values --- Error --- 2
CustPaymentType
PaymentType has invalid enum values --- Error --- 2
CustVendPaymStatus
PaymentStatus has invalid enum values --- Error --- 2
PaymSumBy
SumByPeriod has invalid enum values --- Error --- 2
TypeOfDraft
BillOfExchangeDraftType has invalid enum values --- Error --- 2











------> Tax Regisration Customer

Description is null --- Warning --- 3
RegistrationNumber is null --- Error --- 2
ValidFrom is null --- Warning --- 3
ValidTo is null --- Warning --- 3
CountryRegionId is null --- Error --- 2
TaxRegstrationType is null --- Error --- 2
CustAccountNum is null --- Error --- 2
CustAccountName is null --- Warning --- 3
LegalEntity is null --- Error --- 2

RegistrationNumber, ValidFrom, ValidTo, CountryRegionId, TaxRegstrationType, CustAccountNum, LegalEntity,DATAAREAID has duplicate values

CountryRegionId is not there in COUNTRYREGION of country --- Error --- 2
CustAccountNum is not there in CUSTOMERACCOUNT of Customer --- Error --- 2
LegalEntity is not there in LEGALENTITYID of legal entities --- Error --- 2
TaxRegstrationType is not there in RegistrationType of Sale Tax Registration Type --- Error --- 2











---> Line of Business

LINEOFBUSINESS is blank --- Error --- 2
DESCRIPTION is blank --- Warning --- 3
LINEOFBUSINESS,DATAAREAID has duplicate values --- Constraint --- 1




---> Company Chains

CHAINNAME is blank --- Error --- 2
CHAINDESCRIPTION is blank --- Warning --- 2
CHAINNAME,DATAAREAID has duplicate values --- Constraint --- 1




---> Sales District

DistrictId is blank --- Error --- 2
DistrictDescription is blank --- Warning --- 3

DistrictId,DATAAREAID has duplicate value --- Constraint --- 1





---> Customer Groups

TaxGroupId is blank --- Error --- 2
PaymentTermId is blank --- Waning --- 3
Description is blank --- Warning --- 3
CustomerGroupId,DATAAREAID has duplicate values --- Constraint --- 1

TaxGroupId is not there in TAXGROUPCODE of Sales Tax Group -- Error --- 2
PaymentTermId is not there in NAME of Terms of Payment table --- Error --- 2






------> Order Entry Deadline Groups

GROUPID is blank --- Error --- 2
GROUPDESCRIPTION is blank --- Warning --- 3

GROUPID,DATAAREAID has duplicte values ---- Constraint --- 1






---------> Business Segments

SegmentCode is blank --- Error --- 2
SegmentDescription is blank --- Warning --- 3

SegmentCode,DATAAREAID has duplicate values ---- Constraint --- 1






-------> Business Subsegments

SubsegmentCode is blank --- Error --- 2
BusinessSegmentCode is blank --- Warning --- 2
SubsegmentDescription is blank --- Warning --- 2

BusinessSegmentCode,SubsegmentCode,DATAAREAID has duplicate values --- Constraint --- 1

BusinessSegmentCode is not there in SegmentCode of Business Segments --- Error --- 2






--------> Statistics Group

STATISTICSGROUP is blank --- Error --- 2
DESCRIPTION is blank --- Warning --- 3

STATISTICSGROUP,DATAAREAID has duplicate values ---- Constraint --- 1

STATISTICSGROUP has string size more than 10 --- Constraint ------ 1



-------------------------------- Validation Scripts -----------------------------------------------


---Customers 

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CustomerCodeLegacy= '' or CustomerCodeLegacy is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ORGANIZATIONNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ORGANIZATIONNAME= '' or ORGANIZATIONNAME is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'FinancialDimensionCostCenter is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		FinancialDimensionCostCenter= '' or FinancialDimensionCostCenter is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CUSTOMERGROUPID= '' or CUSTOMERGROUPID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESCURRENCYCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SALESCURRENCYCODE= '' or SALESCURRENCYCODE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSDESCRIPTION= '' or ADDRESSDESCRIPTION is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDITLIMIT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CREDITLIMIT= '' or CREDITLIMIT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDMANCREDITLIMITEXPIRYDATE is blank where CREDITLIIMT is not blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CREDITLIIMT IS NOT NULL AND (CREDMANCREDITLIMITEXPIRYDATE= '' or CREDMANCREDITLIMITEXPIRYDATE is null)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'FinancialDimensionIntercompany is blank when CUSTOMERGROUPID IS IN','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		FinancialDimensionIntercompany= '' or FinancialDimensionIntercompany is null) AND CUSTOMERGROUPID LIKE 'IC'

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSIONOPERATINGUNIT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		FINANCIALDIMENSIONOPERATINGUNIT= '' or FINANCIALDIMENSIONOPERATINGUNIT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSIONLOB is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		FINANCIALDIMENSIONLOB= '' or FINANCIALDIMENSIONLOB is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'StockReservationPriority is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		StockReservationPriority= '' or StockReservationPriority is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ORGANIZATIONNAME is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ORGANIZATIONNAME= '' or ORGANIZATIONNAME is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTBANKACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PAYMENTBANKACCOUNT= '' or PAYMENTBANKACCOUNT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLOCATIONROLES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSLOCATIONROLES= '' or ADDRESSLOCATIONROLES is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCOUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSCOUNTRYREGIONID= '' or ADDRESSCOUNTRYREGIONID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'NAMEALIAS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		NAMEALIAS= '' or NAMEALIAS is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		LANGUAGEID= '' or LANGUAGEID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'FULLPRIMARYADDRESS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		FULLPRIMARYADDRESS= '' or FULLPRIMARYADDRESS is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCITY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSCITY= '' or ADDRESSCITY is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYCONTACTEMAIL is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PRIMARYCONTACTEMAIL= '' or PRIMARYCONTACTEMAIL is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYCONTACTEMAILDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PRIMARYCONTACTEMAILDESCRIPTION= '' or PRIMARYCONTACTEMAILDESCRIPTION is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTTERMS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PAYMENTTERMS= '' or PAYMENTTERMS is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTMETHOD is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PAYMENTMETHOD= '' or PAYMENTMETHOD is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESTAXGROUP is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SALESTAXGROUP= '' or SALESTAXGROUP is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'RECEIPTOPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		RECEIPTOPTION= '' or RECEIPTOPTION is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYADDRESSCOUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DELIVERYADDRESSCOUNTRYREGIONID= '' or DELIVERYADDRESSCOUNTRYREGIONID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDMANCUSTOMERSINCE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CREDMANCUSTOMERSINCE= '' or CREDMANCUSTOMERSINCE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYCONTACTPHONEDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		PRIMARYCONTACTPHONEDESCRIPTION= '' or PRIMARYCONTACTPHONEDESCRIPTION is null
UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'INVOICEACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		INVOICEACCOUNT= '' or INVOICEACCOUNT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLATITUDE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSLATITUDE= '' or ADDRESSLATITUDE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLONGITUDE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSLONGITUDE= '' or ADDRESSLONGITUDE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DomainLegacy is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DomainLegacy= '' or DomainLegacy is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'EntityLegacy is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		EntityLegacy= '' or EntityLegacy is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CommercialRegName is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CommercialRegName= '' or CommercialRegName is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'OpenTime is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		OpenTime= '' or OpenTime is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ClosingTime is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ClosingTime= '' or ClosingTime is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DeliveryStartSlot1 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DeliveryStartSlot1= '' or DeliveryStartSlot1 is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DeliveryEndSlot1 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DeliveryEndSlot1= '' or DeliveryEndSlot1 is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DeliveryStartSlot2 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DeliveryStartSlot2= '' or DeliveryStartSlot2 is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DeliveryEndSlot2 is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DeliveryEndSlot2= '' or DeliveryEndSlot2 is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'OwnerName is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		OwnerName= '' or OwnerName is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'IsTaxable is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		IsTaxable= '' or IsTaxable is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ORDERENTRYDEADLINE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ORDERENTRYDEADLINE= '' or ORDERENTRYDEADLINE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'VENDORACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		VENDORACCOUNT= '' or VENDORACCOUNT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDMANACCOUNTSTATUSID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CREDMANACCOUNTSTATUSID= '' or CREDMANACCOUNTSTATUSID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERARABICNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CUSTOMERARABICNAME= '' or CUSTOMERARABICNAME is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYTERMS is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DELIVERYTERMS= '' or DELIVERYTERMS is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'COMPANYCHAIN is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		COMPANYCHAIN= '' or COMPANYCHAIN is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXEXEMPTNUMBER is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		TAXEXEMPTNUMBER= '' or TAXEXEMPTNUMBER is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSEGMENTID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SALESSEGMENTID= '' or SALESSEGMENTID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSUBSEGMENTID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SALESSUBSEGMENTID= '' or SALESSUBSEGMENTID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'STATISTICGROUP is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		STATISTICGROUP= '' or STATISTICGROUP is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESDISTRICT is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SALESDISTRICT= '' or SALESDISTRICT is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'LINEOFBUSINESSID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		LINEOFBUSINESSID= '' or LINEOFBUSINESSID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'IDENTIFICATIONNUMBER is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		IDENTIFICATIONNUMBER= '' or IDENTIFICATIONNUMBER is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DEFAULTDIMENSIONDISPLAYVALUE is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DEFAULTDIMENSIONDISPLAYVALUE= '' or DEFAULTDIMENSIONDISPLAYVALUE is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'INTERCOMPANY is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		INTERCOMPANY= '' or INTERCOMPANY is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'COMPANYLECODE is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		COMPANYLECODE= '' or COMPANYLECODE is null


------------------------------------------------------------------- Added columns -------------------------------------------------------------

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerPriceLevel is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CustomerPriceLevel= '' or CustomerPriceLevel is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DISCOUNTPRICEGROUPID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		DISCOUNTPRICEGROUPID= '' or DISCOUNTPRICEGROUPID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SITEID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SITEID= '' or SITEID is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'TotalPendingInvoices is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		TotalPendingInvoices= '' or TotalPendingInvoices is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SalesMode is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		SalesMode= '' or SalesMode is null

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTCLASSIFICATIONID is null','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CUSTCLASSIFICATIONID= '' or CUSTCLASSIFICATIONID is null










------------------ Check that atleast for a few customers having value in PAYMENT METHOD field, other than "Cash", the fields CREDITLIIMT and  are populated----------

SELECT COUNT(*) FROM PWC_E_CUSTOMERV3	
	WHERE 
		UPPER(PAYMENTMETHOD) NOT LIKE 'Cash' AND (CREDITLIMIT IS NOT NULL OR CREDITLIMIT IS NOT LIKE '0%' OR CREDITLIMIT NOT LIKE '0.%')

SELECT COUNT(*) FROM PWC_E_CUSTOMERV3	
	WHERE 
		UPPER(PAYMENTMETHOD) NOT LIKE 'Cash' AND CREDMANCREDITLIMITEXPIRYDATE IS NOT NULL

-------------------------------------- End -----------------------------------

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'No customers with CUSTOMERGROUPID as EX should be present in AEP1','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE
            CUSTOMERGROUPID LIKE 'EX' AND DATAAREAID LIKE 'AEP1'

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'No customers in AEP1 should have CUSTOMERGROUPID other than IC, RP, ST and AF','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE
            CUSTOMERGROUPID NOT IN ('IC', 'RP', 'ST', 'AF') AND DATAAREAID LIKE 'AEP1'

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDITLIMIT should be blank or 0 when PAYMENTMETHOD is "Cash"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		UPPER(PAYMENTMETHOD) LIKE 'Cash' AND (CREDITLIMIT IS NOT NULL OR CREDITLIMIT IS NOT LIKE '0%' OR CREDITLIMIT NOT LIKE '0.%')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDMANCREDITLIMITEXPIRYDATE should be blank when PAYMENTMETHOD is "Cash"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		UPPER(PAYMENTMETHOD) LIKE 'Cash' AND CREDMANCREDITLIMITEXPIRYDATE IS NOT NULL

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNT is having a circular reference (Suparna)','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
    FROM PWC_E_CUSTOMERV3 A
    WHERE
    CUSTOMERCODELEGACY IN
    (SELECT B.INVOICEACCOUNT FROM PWC_E_CUSTOMERV3 B WHERE B.CUSTOMERCODELEGACY=A.INVOICEACCOUNT AND B.CUSTOMERCODELEGACY <> B.INVOICEACCOUNT AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL'))


UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNT is not having the correct number sequence','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
    FROM PWC_E_CUSTOMERV3
    WHERE
        CUSTOMERACCOUNT IS NOT NULL AND CUSTOMERACCOUNT IN
        (SELECT CUSTOMERACCOUNT FROM PWC_E_CUSTOMERV3 WHERE CUSTOMERACCOUNT NOT LIKE DataAreaID + '[0-9][0-9][0-9][0-9][0-9][0-9]')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYMODE should not be null if DATAAREAID is 'AEB1'','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		(DELIVERYMODE= '' or DELIVERYMODE is null) and DATAAREAID like 'AEB1'

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'COMMERCIALREGEXPIRY HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		COMMERCIALREGEXPIRY IS NOT NULL AND ISDATE(COMMERCIALREGEXPIRY) = 0

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'ADDRESSVALIDFROM HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		ADDRESSVALIDFROM IS NOT NULL AND ISDATE(ADDRESSVALIDFROM) = 0

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'CREDMANCREDITLIMITEXPIRYDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		CREDMANCREDITLIMITEXPIRYDATE IS NOT NULL AND ISDATE(CREDMANCREDITLIMITEXPIRYDATE) = 0

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'ADDRESSCOUNTRYREGIONID, ADDRESSCITY, ADDRESSSTATE is not matching with the Address master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_CUSTOMERV3 
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND
		ADDRESSCITY IS NOT NULL AND
		ADDRESSSTATE IS NOT NULL AND CONCAT(ADDRESSCOUNTRYREGIONID, ADDRESSCITY, ADDRESSSTATE) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME, B.STATEID) FROM PWC_E_CITY B)

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'ADDRESSCOUNTRYREGIONID, ADDRESSCITY is not matching with the Address master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_CUSTOMERV3 
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND
		ADDRESSCITY IS NOT NULL AND
		CONCAT(ADDRESSCOUNTRYREGIONID, ADDRESSCITY) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME) FROM PWC_E_CITY B)

DECLARE @Time Nvarchar(15)  
SELECT @Time = OPENTIME FROM PWC_E_CUSTOMERV3
UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'OPENTIME HAS WRONG TIME FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		OPENTIME IS NOT NULL AND
		(ISNUMERIC(REPLACE(@Time,':','')) = 0 OR
		(SUBSTRING(@Time,1,2) > 24) OR 
		(SUBSTRING(@Time,4,2) > 60) OR
		(SUBSTRING(@Time,7,2) > 60))
GO

DECLARE @Time Nvarchar(15)  
SELECT @Time = CLOSINGTIME FROM PWC_E_CUSTOMERV3
UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'CLOSINGTIME HAS WRONG TIME FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		CLOSINGTIME IS NOT NULL AND
		(ISNUMERIC(REPLACE(@Time,':','')) = 0 OR
		(SUBSTRING(@Time,1,2) > 24) OR 
		(SUBSTRING(@Time,4,2) > 60) OR
		(SUBSTRING(@Time,7,2) > 60))
GO

DECLARE @Time Nvarchar(15)  
SELECT @Time = DeliveryStartSlot1 FROM PWC_E_CUSTOMERV3
UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'DeliveryStartSlot1 HAS WRONG TIME FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		DeliveryStartSlot1 IS NOT NULL AND
		(ISNUMERIC(REPLACE(@Time,':','')) = 0 OR
		(SUBSTRING(@Time,1,2) > 24) OR 
		(SUBSTRING(@Time,4,2) > 60) OR
		(SUBSTRING(@Time,7,2) > 60)) 
GO

DECLARE @Time Nvarchar(15)  
SELECT @Time = DeliveryEndSlot1 FROM PWC_E_CUSTOMERV3
UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC, 'DeliveryEndSlot1 HAS WRONG TIME FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE
		DeliveryEndSlot1 IS NOT NULL AND
		(ISNUMERIC(REPLACE(@Time,':','')) = 0 OR
		(SUBSTRING(@Time,1,2) > 24) OR 
		(SUBSTRING(@Time,4,2) > 60) OR
		(SUBSTRING(@Time,7,2) > 60))
GO 

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'CREDITLIMIT is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CREDITLIMIT LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'ADDRESSLATITUDE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSLATITUDE LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'ADDRESSLONGITUDE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ADDRESSLONGITUDE LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'TotalPendingInvoices is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		TotalPendingInvoices LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'SALESSEGMENTID,SALESSUBSEGMENTID,DATAAREAID is not matching with the Business Submsegments','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE
		SALESSEGMENTID IS NOT NULL AND
		SALESSUBSEGMENTID IS NOT NULL AND
		CONCAT(SALESSEGMENTID,SALESSUBSEGMENTID) NOT IN 
		(SELECT CONCAT(BusinessSegmentCode,SubsegmentCode) FROM PWC_E_CUSTBUSINESSSUBSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL'))


UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCOUNTRYREGIONID not in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND ADDRESSCOUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYMODE not in MODECODE of Modes of Delivery','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		DELIVERYMODE IS NOT NULL AND DELIVERYMODE NOT IN 
		(SELECT B.MODECODE FROM PWC_E_MODEOFDELIVERY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.MODECODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerCodeLegacy,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CustomerCodeLegacy IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(CustomerCodeLegacy,DATAAREAID) IN 
		(SELECT CONCAT(CustomerCodeLegacy,DATAAREAID) FROM PWC_E_CUSTOMERV3
		GROUP BY CustomerCodeLegacy,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNT,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		CUSTOMERACCOUNT IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(CUSTOMERACCOUNT,DATAAREAID) IN 
		(SELECT CONCAT(CUSTOMERACCOUNT,DATAAREAID) FROM PWC_E_CUSTOMERV3
		GROUP BY CUSTOMERACCOUNT,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC,'FinancialDimensionCostCenter is not there in DIMENSIONVALUE of Cost Center Financial Dimension','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE FinancialDimensionCostCenter is not null and FinancialDimensionCostCenter not in
	(select DIMENSIONVALUE from PWC_E_FINDIMVALUES WHERE FINANCIALDIMENSION LIKE 'Cost%')

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC,'FinancialDimensionIntercompany is not there in DIMENSIONVALUE of Intercompany Financial Dimension','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE FinancialDimensionIntercompany is not null and FinancialDimensionIntercompany not in
	(select DIMENSIONVALUE from PWC_E_FINDIMVALUES WHERE FINANCIALDIMENSION LIKE 'Inter%')

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSIONOPERATINGUNIT is not there in DIMENSIONVALUE of Operating Unit Financial Dimension','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE FINANCIALDIMENSIONOPERATINGUNIT is not null and FINANCIALDIMENSIONOPERATINGUNIT not in
	(select DIMENSIONVALUE from PWC_E_FINDIMVALUES WHERE FINANCIALDIMENSION LIKE 'Op%')

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC,'FINANCIALDIMENSIONLOB is not there in DIMENSIONVALUE of LOB Financial Dimension','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3
	WHERE FINANCIALDIMENSIONLOB is not null and FINANCIALDIMENSIONLOB not in
	(select DIMENSIONVALUE from PWC_E_FINDIMVALUES WHERE FINANCIALDIMENSION LIKE 'L%')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERGROUPID not in CustomerGroupId of customer groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		CUSTOMERGROUPID IS NOT NULL AND CUSTOMERGROUPID NOT IN 
		(SELECT B.CustomerGroupId FROM PWC_E_CUSTOMERGROUP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerGroupId IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID not in LanguageCodeId of Language Codes','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		LANGUAGEID IS NOT NULL AND LANGUAGEID NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCITY not in NAME of City','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		ADDRESSCITY IS NOT NULL AND ADDRESSCITY NOT IN 
		(SELECT B.NAME FROM PWC_E_CITY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSSTATE not in STATE of State','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		ADDRESSSTATE IS NOT NULL AND ADDRESSSTATE NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'ACCOUNTSTATEMENT has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		ACCOUNTSTATEMENT IS NOT NULL AND ACCOUNTSTATEMENT NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CustAccountStatement')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESCURRENCYCODE is not in CURRENCYCODE of currencies','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE
		SALESCURRENCYCODE IS NOT NULL AND SALESCURRENCYCODE NOT IN 
		(SELECT B.CURRENCYCODE FROM PWC_E_CURRENCIES B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CURRENCYCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTTERMS is not in NAME of Customer terms of payment','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		PAYMENTTERMS IS NOT NULL AND PAYMENTTERMS NOT IN 
		(SELECT B.NAME FROM PWC_E_TERMSOFPAYMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTMETHOD is not in Name of Customer payment method','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		PAYMENTMETHOD IS NOT NULL AND PAYMENTMETHOD NOT IN 
		(SELECT B.Name FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESTAXGROUP is not in TAXGROUPCODE of Sales Tax Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		SALESTAXGROUP IS NOT NULL AND SALESTAXGROUP NOT IN 
		(SELECT B.TAXGROUPCODE FROM PWC_E_SALESTAXGROUPS B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.TAXGROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'RECEIPTOPTION has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE
		RECEIPTOPTION IS NOT NULL AND RECEIPTOPTION NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'RetailReceiptOptionBase') AND
		(RECEIPTOPTION NOT LIKE 'STANDARD RECEIPT')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYADDRESSCOUNTRYREGIONID not in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		DELIVERYADDRESSCOUNTRYREGIONID IS NOT NULL AND DELIVERYADDRESSCOUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'INVOICEACCOUNT not in CustomerCodeLegacy of Customers Table','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		INVOICEACCOUNT IS NOT NULL AND INVOICEACCOUNT NOT IN 
		(SELECT B.CustomerCodeLegacy FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerCodeLegacy IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'VENDORACCOUNT is not in VENDORACCOUNTNUMBER of Vendors','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		VENDORACCOUNT IS NOT NULL AND VENDORACCOUNT NOT IN 
		(SELECT B.VENDORACCOUNTNUMBER FROM PWC_E_VENDOR B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.VENDORACCOUNTNUMBER IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DELIVERYTERMS is  not in TermsCode of Terms of Delivery table','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		DELIVERYTERMS IS NOT NULL AND DELIVERYTERMS NOT IN 
		(SELECT B.TermsCode FROM PWC_E_TERMSOFDELIVERY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.TermsCode IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'COMPANYCHAIN is not in CHAINNAME of Company Chains','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		COMPANYCHAIN IS NOT NULL AND COMPANYCHAIN NOT IN 
		(SELECT B.CHAINNAME FROM PWC_E_COMPANYCHAIN B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CHAINNAME IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXEXEMPTNUMBER is not in VATNum of Sales Tax Exempt Numbers','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		TAXEXEMPTNUMBER IS NOT NULL AND TAXEXEMPTNUMBER NOT IN 
		(SELECT B.VATNum FROM PWC_E_SALESTAXEXEMPTNUMBER B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.VATNum IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSEGMENTID is not in SegmentCode of Customer Business Segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		SALESSEGMENTID IS NOT NULL AND SALESSEGMENTID NOT IN 
		(SELECT B.SegmentCode FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESSUBSEGMENTID is not in SubsegmentCode of Customer Business SubSegments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		SALESSUBSEGMENTID IS NOT NULL AND SALESSUBSEGMENTID NOT IN 
		(SELECT B.SubsegmentCode FROM PWC_E_CUSTBUSINESSSUBSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SubsegmentCode IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESDISTRICT is not in DistrictId of Sales District','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		SALESDISTRICT IS NOT NULL AND SALESSUBSEGMENTID NOT IN 
		(SELECT B.DistrictId FROM PWC_E_SALESDISTRICT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.DistrictId IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'STATISTICGROUP is not in STATISTICSGROUP of Customer Statistic Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		STATISTICGROUP IS NOT NULL AND STATISTICGROUP NOT IN 
		(SELECT B.STATISTICSGROUP FROM PWC_E_STATISTICGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.STATISTICSGROUP IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'LINEOFBUSINESSID is not in LINEOFBUSINESS of Customer Line of Business','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		LINEOFBUSINESSID IS NOT NULL AND LINEOFBUSINESSID NOT IN 
		(SELECT B.LINEOFBUSINESS FROM PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.LINEOFBUSINESS IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTBANKACCOUNT is not in BANKACCOUNTID of Customer Bank Account','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		PAYMENTBANKACCOUNT IS NOT NULL AND PAYMENTBANKACCOUNT NOT IN 
		(SELECT B.BANKACCOUNTID FROM PWC_E_CUSTOMERBANKACCOUNT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.BANKACCOUNTID IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'PAYMENTBANKACCOUNT,CustomerCodeLegacy  is not matching with Customer Bank Account','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		PAYMENTBANKACCOUNT IS NOT NULL AND CustomerCodeLegacy IS NOT NULL AND CONCAT(PAYMENTBANKACCOUNT, CustomerCodeLegacy) NOT IN 
		(SELECT CONCAT(B.BANKACCOUNTID, B.CUSTOMERACCOUNTNUMBER) FROM PWC_E_CUSTOMERBANKACCOUNT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.BANKACCOUNTID IS NOT NULL)



----------------------------------------------------------- Added ---------------------------------------------------

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SALESMODE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		LOWER( CashOrCreditFlag ) NOT IN ('cash', 'credit')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'DISCOUNTPRICEGROUPID is not in GROUPCODE of Price Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		DISCOUNTPRICEGROUPID IS NOT NULL AND DISCOUNTPRICEGROUPID NOT IN 
		(SELECT B.GROUPCODE FROM PWC_E_PRICECUSTGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'SITEID is not in SITEID of Sites','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		SITEID IS NOT NULL AND SITEID NOT IN 
		(SELECT B.SITEID FROM PWC_E_SITEERP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SITEID IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'StockReservationPriority has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		LOWER( StockReservationPriority ) NOT IN ('p1', 'p2')

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerPriceLevel is not in TRADEAGREEMENTJOURNALNAMEID of Trade Agreement Journals','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A	
	WHERE 
		CustomerPriceLevel IS NOT NULL AND CustomerPriceLevel NOT IN 
		(SELECT B.TRADEAGREEMENTJOURNALNAMEID FROM PWC_E_TRADEAGGREMENTJRNL B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.TRADEAGREEMENTJOURNALNAMEID IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERCODELEGACY is not there in CUSTOMERACCOUNTNUMBER of Customer Addresses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3 A
	WHERE 
		CUSTOMERCODELEGACY IS NOT NULL AND CUSTOMERCODELEGACY NOT IN 
		(SELECT B.CUSTOMERACCOUNTNUMBER FROM PWC_E_CUSTADDR B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERACCOUNTNUMBER IS NOT NULL)

UPDATE PWC_E_CUSTOMERV3 
	SET ERRORDESC = CONCAT(ERRORDESC,'NATUREOFASSESSEE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERV3	
	WHERE 
		NATUREOFASSESSEE IS NOT NULL AND (NATUREOFASSESSEE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'NatureOfAssessee_IN') OR UPPER(NATUREOFASSESSEE) NOT LIKE 'LOCAL AUTHORITY')



























-------------- Risk Group

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'From is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CREDITBLRISKGRP	
	WHERE 
		From LIKE '%[^0-9.]%'

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'To is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CREDITBLRISKGRP	
	WHERE 
		To LIKE '%[^0-9.]%'

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC, 'From IS NOT LESS THAN OR EQUAL TO To','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE
		TRY_CAST(From AS float) IS NOT NULL AND
		TRY_CAST(To AS float) IS NOT NULL AND
		TRY_CAST(To AS float) < TRY_CAST(From AS float)

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RiskGroup is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE 
		RiskGroup= '' or RiskGroup is null

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'From is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE 
		From= '' or From is null

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'To is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE 
		To= '' or To is null

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RiskGroupIndicator is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE 
		RiskGroupIndicator= '' or RiskGroupIndicator is null

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RiskGroup,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE
		RiskGroup IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(RiskGroup,DATAAREAID) IN 
		(SELECT CONCAT(RiskGroup,DATAAREAID) FROM PWC_E_CREDITBLRISKGRP
		GROUP BY RiskGroup,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CREDITBLRISKGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RiskGroupIndicator enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITBLRISKGRP
	WHERE 
		RiskGroupIndicator IS NOT NULL AND RiskGroupIndicator NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CredManRiskGroupIndicator')















--------------- Scoring Groups

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE 
		GROUPID= '' or GROUPID is null

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE 
		GROUPTYPE= '' or GROUPTYPE is null

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RISKSCORETYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE 
		RISKSCORETYPE= '' or RISKSCORETYPE is null

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE
		GROUPID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(GROUPID,DATAAREAID) IN 
		(SELECT CONCAT(GROUPID,DATAAREAID) FROM PWC_E_CREDITTBLSCORINGGRP
		GROUP BY GROUPID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'RISKSCORETYPE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE 
		RISKSCORETYPE IS NOT NULL AND RISKSCORETYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CredManRiskScoreType')

UPDATE PWC_E_CREDITTBLSCORINGGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPTYPE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRP
	WHERE 
		GROUPTYPE IS NOT NULL AND GROUPTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CredManRiskGroupType')


















---------------- Scoring Group setup

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'RANGEFROM is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP	
	WHERE 
		RANGEFROM LIKE '%[^0-9.]%'

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'RANGETO is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP	
	WHERE 
		RANGETO LIKE '%[^0-9.]%'

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC, 'RANGEFROM should not be greater than RANGETO','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE
		TRY_CAST(RANGEFROM AS float) IS NOT NULL AND
		TRY_CAST(RANGETO AS float) IS NOT NULL AND
		TRY_CAST(RANGETO AS float) < TRY_CAST(RANGEFROM AS float)

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'SCORE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP	
	WHERE 
		SCORE LIKE '%[^0-9.]%'

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE 
		GROUPID= '' or GROUPID is null

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'RANGEFROM is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE 
		RANGEFROM= '' or RANGEFROM is null

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'RANGETO is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE 
		RANGETO= '' or RANGETO is null

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'SCORE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE 
		SCORE= '' or SCORE is null

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID,RANGEFROM,RANGETO,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP
	WHERE
		GROUPID IS NOT NULL AND 
		RANGEFROM IS NOT NULL AND 
        RANGETO IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(GROUPID,RANGEFROM,RANGETO,DATAAREAID) IN 
		(SELECT CONCAT(GROUPID,RANGEFROM,RANGETO,DATAAREAID) FROM PWC_E_CUSTCREDITCTRLLINE
		GROUP BY GROUPID,RANGEFROM,RANGETO,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CREDITTBLSCORINGGRPSETUP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID is not there in CUSTOMERACCOUNT of Customer Master','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CREDITTBLSCORINGGRPSETUP A
	WHERE 
		GROUPID IS NOT NULL AND GROUPID NOT IN 
		(SELECT B.GROUPID FROM PWC_E_CREDITTBLSCORINGGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPID IS NOT NULL)

























-------------- Customer Credit Control Line

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC, 'EXPIRYDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE
		EXPIRYDATE IS NOT NULL AND ISDATE(EXPIRYDATE) = 0

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC, 'FROMDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE
		FROMDATE IS NOT NULL AND ISDATE(FROMDATE) = 0

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC, 'FROMDATE IS NOT LESS THAN OR EQUAL TO EXPIRYDATE','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE
		FROMDATE IS NOT NULL AND EXPIRYDATE IS NOT NULL
		AND ERRORDESC NOT LIKE '%WRONG DATE FORMAT%'
		AND CAST(FROMDATE AS DATE) > CAST(EXPIRYDATE AS DATE)

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'CREDITMAXNEW is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE	
	WHERE 
		CREDITMAXNEW LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'LINENUM is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE	
	WHERE 
		LINENUM LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'PWCTEMPORARYCREDITLIMIT is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE	
	WHERE 
		PWCTEMPORARYCREDITLIMIT LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'CREDITMAXNEW is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		CREDITMAXNEW= '' or CREDITMAXNEW is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		CUSTACCOUNT= '' or CUSTACCOUNT is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'EXPIRYDATE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		EXPIRYDATE= '' or EXPIRYDATE is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'FROMDATE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		FROMDATE= '' or FROMDATE is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'JOURNALID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		JOURNALID= '' or JOURNALID is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'LINENUM is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		LINENUM= '' or LINENUM is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCTEMPORARYCREDITLIMIT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE 
		PWCTEMPORARYCREDITLIMIT= '' or PWCTEMPORARYCREDITLIMIT is null

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'JOURNALID,LINENUM,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE
	WHERE
		JOURNALID IS NOT NULL AND 
		LINENUM IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(JOURNALID,LINENUM,DATAAREAID) IN 
		(SELECT CONCAT(JOURNALID,LINENUM,DATAAREAID) FROM PWC_E_CUSTCREDITCTRLLINE
		GROUP BY JOURNALID,LINENUM,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTACCOUNT is not there in CUSTOMERACCOUNT of Customer Master','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE A
	WHERE 
		CUSTACCOUNT IS NOT NULL AND CUSTACCOUNT NOT IN 
		(SELECT B.CUSTOMERACCOUNT FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERACCOUNT IS NOT NULL)

UPDATE PWC_E_CUSTCREDITCTRLLINE
	SET ERRORDESC = CONCAT(ERRORDESC,'JOURNALID is not there in CUSTOMERACCOUNT of Customer Master','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCREDITCTRLLINE A
	WHERE 
		JOURNALID IS NOT NULL AND JOURNALID NOT IN 
		(SELECT B.JOURNALID FROM PWC_E_CUSTCREDITCTRLHDR B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.JOURNALID IS NOT NULL)



























-------------- Customer Bank Accounts

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'BANKACCOUNTNUMBER is blank when IBAN IS NOT blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		(BANKACCOUNTNUMBER= '' or BANKACCOUNTNUMBER is null) AND IBAN IS NOT NULL

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		CUSTOMERACCOUNTNUMBER= '' or CUSTOMERACCOUNTNUMBER is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'BANKACCOUNTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		BANKACCOUNTID= '' or BANKACCOUNTID is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'BANKNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		BANKNAME= '' or BANKNAME is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CURRENCYCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		CURRENCYCODE= '' or CURRENCYCODE is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'IBAN is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		IBAN= '' or IBAN is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'SWIFTCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		SWIFTCODE= '' or SWIFTCODE is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTPERSONNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		CONTACTPERSONNAME= '' or CONTACTPERSONNAME is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'ISDEFAULTBANKACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		ISDEFAULTBANKACCOUNT= '' or ISDEFAULTBANKACCOUNT is null

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER is not there in CUSTOMERACCOUNT of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT A
	WHERE 
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND CUSTOMERACCOUNTNUMBER NOT IN 
		(SELECT B.CUSTOMERCODELEGACY FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERCODELEGACY IS NOT NULL)

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CURRENCYCODE is not there in CURRENCYCODE of Currencies','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT A
	WHERE 
		CURRENCYCODE IS NOT NULL AND CURRENCYCODE NOT IN 
		(SELECT B.CURRENCYCODE FROM PWC_E_CURRENCIES  B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CURRENCYCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'ROUTINGNUMBERTYPE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE 
		ROUTINGNUMBERTYPE IS NOT NULL AND ROUTINGNUMBERTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'BankCodeType')

UPDATE PWC_E_CUSTOMERBANKACCOUNT
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER,BANKACCOUNTID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTOMERBANKACCOUNT
	WHERE
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND 
		BANKACCOUNTID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(CUSTOMERACCOUNTNUMBER,BANKACCOUNTID,DATAAREAID) IN 
		(SELECT CONCAT(CUSTOMERACCOUNTNUMBER,BANKACCOUNTID,DATAAREAID) FROM PWC_E_CUSTOMERBANKACCOUNT
		GROUP BY CUSTOMERACCOUNTNUMBER,BANKACCOUNTID,DATAAREAID HAVING COUNT(*)>1)






















----- Customer Addresses

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC, 'CUSTOMERACCOUNTNUMBER,ADDRESSLOCATIONROLES, ADDRESSCOUNTRYREGIONID, ADDRESSDESCRIPTION, ADDRESSSTATE, ADDRESSSTREET, ADDRESSZIPCODE is not matching with the Customer master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_CUSTADDR A
	WHERE 
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND
		ISPRIMARY LIKE 'Y%' AND
		CONCAT(TRIM(CUSTOMERACCOUNTNUMBER),TRIM(ADDRESSLOCATIONROLES), TRIM(ADDRESSCOUNTRYREGIONID), TRIM(ADDRESSDECRIPTION), TRIM(ADDRESSSTATE), TRIM(ADDRESSSTREET),TRIM(ADDRESSZIPCODE)) NOT IN
		(SELECT CONCAT(TRIM(B.CustomerCodeLegacy), TRIM(B.ADDRESSLOCATIONROLES), TRIM(B.ADDRESSCOUNTRYREGIONID), TRIM(B.ADDRESSDESCRIPTION), TRIM(B.ADDRESSSTATE), TRIM(B.ADDRESSSTREET), TRIM(B.ADDRESSZIPCODE)) FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID))


UPDATE PWC_E_CUSTADDR
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'ADDRESSLATITUDE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTADDR	
	WHERE 
		ADDRESSLATITUDE LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'ADDRESSLONGITUDE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTADDR	
	WHERE 
		ADDRESSLONGITUDE LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC, 'ADDRESSCOUNTRYREGIONID, ADDRESSCITY, ADDRESSSTATE is not matching with the Address master','; '),
	ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR','; ')
	FROM PWC_E_CUSTADDR 
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND
		ADDRESSCITY IS NOT NULL AND
		ADDRESSSTATE IS NOT NULL AND CONCAT(ADDRESSCOUNTRYREGIONID, ADDRESSCITY, ADDRESSSTATE) NOT IN
		(SELECT CONCAT(B.COUNTRYREGIONID, B.NAME, B.STATE) FROM PWC_E_CITY B)

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER has multiple Primary Addresses','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTADDR
	WHERE
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND 
		UPPER(ISPRIMARY) LIKE '%YES%' AND 
		CONCAT(CUSTOMERACCOUNTNUMBER,ISPRIMARY) IN 
		(SELECT CONCAT(CUSTOMERACCOUNTNUMBER,ISPRIMARY) FROM PWC_E_CUSTADDR
		GROUP BY CUSTOMERACCOUNTNUMBER,ISPRIMARY HAVING COUNT(*)>1) 

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		CUSTOMERACCOUNTNUMBER= '' or CUSTOMERACCOUNTNUMBER is null


UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLOCATIONROLES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSLOCATIONROLES= '' or ADDRESSLOCATIONROLES is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCITY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSCITY= '' or ADDRESSCITY is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCOUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSCOUNTRYREGIONID= '' or ADDRESSCOUNTRYREGIONID is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSDESCRIPTION= '' or ADDRESSDESCRIPTION is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLATITUDE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSLATITUDE= '' or ADDRESSLATITUDE is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSLONGITUDE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSLONGITUDE= '' or ADDRESSLONGITUDE is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSSTATE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSSTATE= '' or ADDRESSSTATE is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSSTREET is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ADDRESSSTREET= '' or ADDRESSSTREET is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPRIMARY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ISPRIMARY= '' or ISPRIMARY is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ISROLEBUSINESS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ISROLEBUSINESS= '' or ISROLEBUSINESS is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ISROLEDELIVERY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTADDR
	WHERE 
		ISROLEDELIVERY= '' or ISROLEDELIVERY is null

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER,CUSTOMERLEGALENTITYID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTADDR
	WHERE
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND 
		CUSTOMERLEGALENTITYID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(CUSTOMERACCOUNTNUMBER,CUSTOMERLEGALENTITYID,DATAAREAID) IN 
		(SELECT CONCAT(CUSTOMERACCOUNTNUMBER,CUSTOMERLEGALENTITYID,DATAAREAID) FROM PWC_E_CUSTADDR
		GROUP BY CUSTOMERACCOUNTNUMBER,CUSTOMERLEGALENTITYID,DATAAREAID HAVING COUNT(*)>1)


UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERACCOUNTNUMBER is not there in CUSTOMERCODELEGACY of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTADDR A
	WHERE 
		CUSTOMERACCOUNTNUMBER IS NOT NULL AND CUSTOMERACCOUNTNUMBER NOT IN 
		(SELECT B.CUSTOMERCODELEGACY FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERCODELEGACY IS NOT NULL)

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCITY is not there in NAME of City','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTADDR A
	WHERE 
		ADDRESSCITY IS NOT NULL AND ADDRESSCITY NOT IN 
		(SELECT B.NAME FROM PWC_E_CITY  B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSCOUNTRYREGIONID is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTADDR A
	WHERE 
		ADDRESSCOUNTRYREGIONID IS NOT NULL AND ADDRESSCOUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CUSTADDR
	SET ERRORDESC = CONCAT(ERRORDESC,'ADDRESSSTATE is not there in STATE of State','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTADDR A
	WHERE 
		ADDRESSSTATE IS NOT NULL AND ADDRESSSTATE NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)



















--------> Party Contacts V3

-----------To check if there is any customer which do not have a primary email/phone/telex--------

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER does not have have a primary EMAIL','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
        CONCAT(PARTYNUMBER,DATAAREAID) IN
        (SELECT CONCAT(PARTYNUMBER,DATAAREAID) FROM PWC_E_CUSTCONTACTSV2
        WHERE UPPER(TYPE) LIKE 'EMAIL' AND UPPER(ISPRIMARY) LIKE 'YES' 
		GROUP BY PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID HAVING COUNT(*)<1)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER does not have have a primary PHONE','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
        CONCAT(PARTYNUMBER,DATAAREAID) IN
        (SELECT CONCAT(PARTYNUMBER,DATAAREAID) FROM PWC_E_CUSTCONTACTSV2
        WHERE UPPER(TYPE) LIKE 'PHONE' AND UPPER(ISPRIMARY) LIKE 'YES' 
		GROUP BY PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID HAVING COUNT(*)<1)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER does not have have a primary TELEX','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
        CONCAT(PARTYNUMBER,DATAAREAID) IN
        (SELECT CONCAT(PARTYNUMBER,DATAAREAID) FROM PWC_E_CUSTCONTACTSV2
        WHERE UPPER(TYPE) LIKE 'TELEX' AND UPPER(ISPRIMARY) LIKE 'YES' 
		GROUP BY PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID HAVING COUNT(*)<1)

------------------------------------------------------------------------------------------------------

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPRIMARY has wrong BOOLEAN FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER( ISPRIMARY ) NOT IN ('no', 'yes')

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,' If TYPE is Phone/Email, then PURPOSE should be Business','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER(TYPE) IN ('phone', 'email') AND LOWER(PURPOSE) NOT LIKE 'business'

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,' If TYPE is Telex, then PURPOSE should be Primary Contact SPOC','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER(TYPE) LIKE 'TEL%' AND LOWER(PURPOSE) NOT LIKE 'prim%'

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,' If TYPE is Phone/Email, then DESCRIPTION should be like Office','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER(TYPE) IN ('phone', 'email') AND LOWER(DESCRIPTION) NOT LIKE '%off%'

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PARTYNUMBER= '' or PARTYNUMBER is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'TYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		TYPE= '' or TYPE is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PURPOSE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PURPOSE= '' or PURPOSE is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'ISPRIMARY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		ISPRIMARY= '' or ISPRIMARY is null

UPDATE PWC_E_CUSTCONTACTSV2
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTCONTACTSV2
	WHERE
		PARTYNUMBER IS NOT NULL AND 
		TYPE IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		UPPER(ISPRIMARY) LIKE 'Y%' AND
		CONCAT(PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID) IN 
		(SELECT CONCAT(PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID) FROM PWC_E_CUSTCONTACTSV2
		GROUP BY PARTYNUMBER,TYPE,ISPRIMARY,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PURPOSE has wrong Enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER( PURPOSE ) NOT IN ('business', 'primary contact spoc')

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'TYPE has wrong Enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		LOWER( TYPE ) NOT IN ('phone', 'email', 'telex')

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYNUMBER is not there in CUSTOMERACCOUNT of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		PARTYNUMBER IS NOT NULL AND PARTYNUMBER NOT IN 
		(SELECT B.CUSTOMERCODELEGACY FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERCODELEGACY IS NOT NULL)







































------> Customer Contacts V2

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTPERSONPARTYTYPE is neither ORGANIZATION nor PERSON','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A
	WHERE
		 CONTACTPERSONPARTYTYPE IS NOT NULL AND LOWER(CONTACTPERSONPARTYTYPE) NOT IN ('organization','person')



UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'ASSOCIATEDPARTYNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		ASSOCIATEDPARTYNUMBER= '' or ASSOCIATEDPARTYNUMBER is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTPERSONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		CONTACTPERSONID= '' or CONTACTPERSONID is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTPERSONNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		CONTACTPERSONNAME= '' or CONTACTPERSONNAME is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTINFORMATIONLANGUAGEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		CONTACTINFORMATIONLANGUAGEID= '' or CONTACTINFORMATIONLANGUAGEID is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCITY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYADDRESSCITY= '' or PRIMARYADDRESSCITY is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID= '' or PRIMARYADDRESSCOUNTRYREGIONID is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONISOCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONISOCODE= '' or PRIMARYADDRESSCOUNTRYREGIONISOCODE is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSSTATEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYADDRESSSTATEID= '' or PRIMARYADDRESSSTATEID is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYPHONENUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYPHONENUMBER= '' or PRIMARYPHONENUMBER is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYEMAILADDRESS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCONTACTSV2	
	WHERE 
		PRIMARYEMAILADDRESS= '' or PRIMARYEMAILADDRESS is null

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'ASSOCIATEDPARTYNUMBER is not there in CUSTOMERACCOUNT of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		ASSOCIATEDPARTYNUMBER IS NOT NULL AND ASSOCIATEDPARTYNUMBER NOT IN 
		(SELECT B.CUSTOMERCODELEGACY FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERCODELEGACY IS NOT NULL)
 
UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'CONTACTINFORMATIONLANGUAGEID is not there in LanguageCodeId of Language Codes','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		CONTACTINFORMATIONLANGUAGEID IS NOT NULL AND CONTACTINFORMATIONLANGUAGEID NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCITY is not there in NAME of City','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		PRIMARYADDRESSCITY IS NOT NULL AND PRIMARYADDRESSCITY NOT IN 
		(SELECT B.NAME FROM PWC_E_CITY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.NAME IS NOT NULL)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONID is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONID IS NOT NULL AND PRIMARYADDRESSCOUNTRYREGIONID NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSCOUNTRYREGIONISOCODE is not there in ISOCODE of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		PRIMARYADDRESSCOUNTRYREGIONISOCODE IS NOT NULL AND PRIMARYADDRESSCOUNTRYREGIONISOCODE NOT IN 
		(SELECT B.ISOCODE FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.ISOCODE IS NOT NULL)

UPDATE PWC_E_CUSTCONTACTSV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PRIMARYADDRESSSTATEID is not there in STATE of States','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCONTACTSV2 A	
	WHERE 
		PRIMARYADDRESSSTATEID IS NOT NULL AND PRIMARYADDRESSSTATEID NOT IN 
		(SELECT B.STATE FROM PWC_E_STATE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.STATE IS NOT NULL)




















--------> Customer Payment Method

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'Name is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		Name= '' or Name is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCPAYMENTTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		PWCPAYMENTTYPE= '' or PWCPAYMENTTYPE is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCPAYMENTINDICATOR is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		PWCPAYMENTINDICATOR= '' or PWCPAYMENTINDICATOR is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'AccountType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		AccountType= '' or AccountType is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BankTransactionType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		BankTransactionType= '' or BankTransactionType is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'ExportBillOfExchangeDuringInvoicePosting is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		ExportBillOfExchangeDuringInvoicePosting= '' or ExportBillOfExchangeDuringInvoicePosting is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PaymentStatus is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		PaymentStatus= '' or PaymentStatus is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SumByPeriod is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		SumByPeriod= '' or SumByPeriod is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'EnablePostdatedCheckClearingPosting is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		EnablePostdatedCheckClearingPosting= '' or EnablePostdatedCheckClearingPosting is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BillOfExchangeDraftType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE 
		BillOfExchangeDraftType= '' or BillOfExchangeDraftType is null

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'Name,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		Name IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(Name,DATAAREAID) IN 
		(SELECT CONCAT(Name,DATAAREAID) FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
		GROUP BY Name,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'AccountType has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		AccountType IS NOT NULL AND AccountType NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'LedgerJournalACType')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PaymentType has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		PaymentType IS NOT NULL AND PaymentType NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CustPaymentType')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PaymentStatus has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		PaymentStatus IS NOT NULL AND PaymentStatus NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'CustVendPaymStatus')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'SumByPeriod has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		SumByPeriod IS NOT NULL AND SumByPeriod NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'PaymSumBy')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'BillOfExchangeDraftType has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING
	WHERE
		BillOfExchangeDraftType IS NOT NULL AND BillOfExchangeDraftType NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TypeOfDraft')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING 
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCPAYMENTTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING	
	WHERE 
		LOWER( PWCPAYMENTTYPE ) NOT IN ('cash', 'cash and cheque')

UPDATE PWC_E_CUSTOMERPAYMENTMETHODSTAGING 
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCPAYMENTINDICATOR has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERPAYMENTMETHODSTAGING	
	WHERE 
		LOWER( PWCPAYMENTINDICATOR ) NOT IN ('None', 'P', 'C', 'D')






















------> Tax Regisration Customer

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC, 'VALIDTO HAS DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE
		VALIDTO IS NOT NULL AND ISDATE(VALIDTO) = 0

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC, 'VALIDFROM HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE
		VALIDFROM IS NOT NULL AND ISDATE(VALIDFROM) = 0

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC, 'VALIDFROM IS NOT LESS THAN OR EQUAL TO VALIDTO','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE
		VALIDFROM IS NOT NULL AND VALIDTO IS NOT NULL
		AND ERRORDESC NOT LIKE '%WRONG DATE FORMAT%'
		AND CAST(VALIDFROM AS DATE) > CAST(VALIDTO AS DATE)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'RegistrationNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		RegistrationNumber= '' or RegistrationNumber is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		CountryRegionId= '' or CountryRegionId is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'TaxRegstrationType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		TaxRegstrationType= '' or TaxRegstrationType is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CustAccountNum is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		CustAccountNum= '' or CustAccountNum is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'LegalEntity is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		LegalEntity= '' or LegalEntity is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'Description is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		Description= '' or Description is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'ValidTo is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		ValidTo= '' or ValidTo is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CustAccountName is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		CustAccountName= '' or CustAccountName is null

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'RegistrationNumber, ValidTo, CountryRegionId, TaxRegstrationType, CustAccountNum, LegalEntity,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTTAXREG
	WHERE 
		RegistrationNumber IS NOT NULL AND 
		ValidTo IS NOT NULL AND 
		CountryRegionId IS NOT NULL AND 
		TaxRegstrationType IS NOT NULL AND 
		CustAccountNum IS NOT NULL AND
		LegalEntity IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND 
		CONCAT(RegistrationNumber, ValidTo, CountryRegionId, TaxRegstrationType, CustAccountNum, LegalEntity,DATAAREAID) IN 
		(SELECT CONCAT(RegistrationNumber, ValidTo, CountryRegionId, TaxRegstrationType, CustAccountNum, LegalEntity,DATAAREAID) FROM PWC_E_CUSTTAXREG
		GROUP BY RegistrationNumber, ValidTo, CountryRegionId, TaxRegstrationType, CustAccountNum, LegalEntity,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG A
	WHERE
		CountryRegionId IS NOT NULL AND CountryRegionId NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CustAccountNum is not there in CUSTOMERACCOUNT of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG A
	WHERE
		CustAccountNum IS NOT NULL AND CustAccountNum NOT IN 
		(SELECT B.CustomerCodeLegacy FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerCodeLegacy IS NOT NULL)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'LegalEntity is not there in LEGALENTITYID of legal entities','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG A
	WHERE
		LegalEntity IS NOT NULL AND LegalEntity NOT IN 
		(SELECT B.LEGALENTITYID FROM PWC_E_LEGALENTITY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.LEGALENTITYID IS NOT NULL)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CustAccountNum, CustAccountName is not there in CUSTOMERACCOUNT,ORGANIZATIONNAME of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG A
	WHERE
		CustAccountNum IS NOT NULL AND 
		CustAccountName IS NOT NULL AND 
		CONCAT(CustAccountNum, CustAccountName) NOT IN 
		(SELECT CONCAT(B.CustomerCodeLegacy, B.ORGANIZATIONNAME) FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR (A.DATAAREAID) = 'GLOBAL') AND B.CustomerCodeLegacy IS NOT NULL AND B.ORGANIZATIONNAME IS NOT NULL)

UPDATE PWC_E_CUSTTAXREG
	SET ERRORDESC = CONCAT(ERRORDESC,'CustAccountNum, CountryRegionId is not there in CUSTOMERACCOUNT,ADDRESSCOUNTRYREGIONID of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTTAXREG A
	WHERE
		CustAccountNum IS NOT NULL AND 
		CountryRegionId IS NOT NULL AND 
		CONCAT(CustAccountNum, CountryRegionId) NOT IN 
		(SELECT CONCAT(B.CustomerCodeLegacy, B.ADDRESSCOUNTRYREGIONID) FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR (A.DATAAREAID) = 'GLOBAL') AND B.CustomerCodeLegacy IS NOT NULL AND B.ADDRESSCOUNTRYREGIONID IS NOT NULL)



































--- Line of Business

UPDATE PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	SET ERRORDESC = CONCAT(ERRORDESC,'LINEOFBUSINESS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	WHERE 
		LINEOFBUSINESS= '' or LINEOFBUSINESS is null
 
UPDATE PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null
 
UPDATE PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	SET ERRORDESC = CONCAT(ERRORDESC,'LINEOFBUSINESS,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
	WHERE 
		LINEOFBUSINESS IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(LINEOFBUSINESS,DATAAREAID) IN 
		(SELECT CONCAT(LINEOFBUSINESS,DATAAREAID) FROM PWC_E_LINEOFBUSINESSSTAGING_CUSTOMER
		GROUP BY LINEOFBUSINESS,DATAAREAID HAVING COUNT(*)>1)


















----- Company Chains

UPDATE PWC_E_COMPANYCHAIN
	SET ERRORDESC = CONCAT(ERRORDESC,'CHAINNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_COMPANYCHAIN
	WHERE 
		CHAINNAME= '' or CHAINNAME is null

UPDATE PWC_E_COMPANYCHAIN
	SET ERRORDESC = CONCAT(ERRORDESC,'CHAINDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_COMPANYCHAIN
	WHERE 
		CHAINNAME= '' or CHAINNAME is null

UPDATE PWC_E_COMPANYCHAIN 
	SET ERRORDESC = CONCAT(ERRORDESC,'CHAINNAME,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_PWC_E_COMPANYCHAIN
	WHERE 
		CHAINNAME IS NOT NULL AND
		DATAAREAID IS NOT NULL AND 
		CONCAT(CHAINNAME,DATAAREAID) IN 
		(SELECT CONCAT(CHAINNAME,DATAAREAID) FROM PWC_E_COMPANYCHAIN 
		GROUP BY CHAINNAME,DATAAREAID HAVING COUNT(*)>1)














----- Sales District

UPDATE PWC_E_SALESDISTRICT
	SET ERRORDESC = CONCAT(ERRORDESC,'DistrictId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESDISTRICT
	WHERE 
		DistrictId= '' or DistrictId is null

UPDATE PWC_E_SALESDISTRICT
	SET ERRORDESC = CONCAT(ERRORDESC,'DistrictDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESDISTRICT
	WHERE 
		DistrictDescription= '' or DistrictDescription is null

UPDATE PWC_E_SALESDISTRICT
	SET ERRORDESC = CONCAT(ERRORDESC,'DistrictId,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_SALESDISTRICT
	WHERE
		DistrictId IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(DistrictId,DATAAREAID) IN 
		(SELECT CONCAT(DistrictId,DATAAREAID) FROM PWC_E_SALESDISTRICT
		GROUP BY DistrictId,DATAAREAID HAVING COUNT(*)>1)











---- Customer Groups

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP
	WHERE 
		CustomerGroupId= '' or CustomerGroupId is null

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'Description is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTOMERGROUP
	WHERE 
		Description= '' or Description is null

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTOMERGROUP
	WHERE
		CustomerGroupId IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(CustomerGroupId,DATAAREAID) IN 
		(SELECT CONCAT(CustomerGroupId,DATAAREAID) FROM PWC_E_CUSTOMERGROUP
		GROUP BY CustomerGroupId,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'TaxGroupId is not there in TAXGROUPCODE of Sales Tax Group','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		TaxGroupId IS NOT NULL AND TaxGroupId NOT IN 
		(SELECT B.TAXGROUPCODE FROM PWC_E_SALESTAXGROUPS B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.TAXGROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'PaymentTermId is not there in NAME of Customer Terms of Payment table','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		PaymentTermId IS NOT NULL AND PaymentTermId NOT IN 
		(SELECT B.NAME FROM PWC_E_TERMSOFPAYMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.Terms IS NOT NULL)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId is not there in GROUPCODE of Price Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		CustomerGroupId IS NOT NULL AND CustomerGroupId NOT IN 
		(SELECT B.GROUPCODE FROM PWC_E_PRICECUSTGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId is not there in SegmentCode of Customer Business Segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		CustomerGroupId IS NOT NULL AND CustomerGroupId NOT IN 
		(SELECT B.SegmentCode FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId, Description is not matching with GROUPCODE,GROUPNAME of Price Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		CONCAT(CustomerGroupId,Description) NOT IN 
		(SELECT CONCAT(B.GROUPCODE,B.GROUPNAME) FROM PWC_E_PRICECUSTGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTOMERGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'CustomerGroupId,Description is not matching with SegmentCode, SegmentDescription of Customer Business Segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTOMERGROUP A
	WHERE 
		CONCAT(CustomerGroupId,Description) NOT IN 
		(SELECT CONCAT(B.SegmentCode,B.SegmentDescription) FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)












------> Order Entry Deadline Groups

UPDATE PWC_E_CUSTORDERENTRYDEADLINEGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTORDERENTRYDEADLINEGRP
	WHERE 
		GROUPID= '' or GROUPID is null

UPDATE PWC_E_CUSTORDERENTRYDEADLINEGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTORDERENTRYDEADLINEGRP
	WHERE 
		GROUPDESCRIPTION= '' or GROUPDESCRIPTION is null

UPDATE PWC_E_CUSTORDERENTRYDEADLINEGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTORDERENTRYDEADLINEGRP
	WHERE
		GROUPID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(GROUPID,DATAAREAID) IN 
		(SELECT CONCAT(GROUPID,DATAAREAID) FROM PWC_E_CUSTORDERENTRYDEADLINEGRP
		GROUP BY GROUPID,DATAAREAID HAVING COUNT(*)>1)












--------- Business Segments

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT
	WHERE 
		SegmentCode= '' or SegmentCode is null

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT
	WHERE 
		SegmentDescription= '' or SegmentDescription is null

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT
	WHERE
		SegmentCode IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(SegmentCode,DATAAREAID) IN 
		(SELECT CONCAT(SegmentCode,DATAAREAID) FROM PWC_E_CUSTBUSINESSSEGMENT
		GROUP BY SegmentCode,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode is not there in GROUPCODE of Price Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		SegmentCode IS NOT NULL AND SegmentCode NOT IN 
		(SELECT B.GROUPCODE FROM PWC_E_PRICECUSTGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode is not there in CustomerGroupId of Customer groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		SegmentCode IS NOT NULL AND SegmentCode NOT IN 
		(SELECT B.CustomerGroupId FROM PWC_E_CUSTOMERGROUP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerGroupId IS NOT NULL)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode,SegmentDescription is not matching with GROUPCODE,GROUPNAME of Price Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		CONCAT(SegmentCode,SegmentDescription) NOT IN 
		(SELECT CONCAT(B.GROUPCODE,B.GROUPNAME) FROM PWC_E_PRICECUSTGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPCODE IS NOT NULL)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SegmentCode,SegmentDescription is not there in CustomerGroupId,Description of Customer groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		CONCAT(SegmentCode,SegmentDescription) NOT IN 
		(SELECT CONCAT(B.CustomerGroupId, B.Description) FROM PWC_E_CUSTOMERGROUP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerGroupId IS NOT NULL)


















-------> Business Subsegments

UPDATE PWC_E_CUSTBUSINESSSUBSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SubsegmentCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSUBSEGMENT
	WHERE 
		SubsegmentCode= '' or SubsegmentCode is null

UPDATE PWC_E_CUSTBUSINESSSUBSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'BusinessSegmentCode is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTBUSINESSSUBSEGMENT
	WHERE 
		BusinessSegmentCode= '' or BusinessSegmentCode is null

UPDATE PWC_E_CUSTBUSINESSSUBSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'SubsegmentDescription is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTBUSINESSSUBSEGMENT
	WHERE 
		SubsegmentDescription= '' or SubsegmentDescription is null

UPDATE PWC_E_CUSTBUSINESSSUBSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'BusinessSegmentCode,SubsegmentCode,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTBUSINESSSUBSEGMENT
	WHERE 
		BusinessSegmentCode IS NOT NULL AND 
		SubsegmentCode IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(BusinessSegmentCode,SubsegmentCode,DATAAREAID) IN 
		(SELECT CONCAT(BusinessSegmentCode,SubsegmentCode,DATAAREAID) FROM PWC_E_CUSTBUSINESSSUBSEGMENT
		GROUP BY BusinessSegmentCode,SubsegmentCode,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTBUSINESSSUBSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'BusinessSegmentCode is not there in SegmentCode of Business Segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSUBSEGMENT A
	WHERE 
		BusinessSegmentCode IS NOT NULL AND BusinessSegmentCode NOT IN 
		(SELECT B.SegmentCode FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)












--------> Statistics Group

UPDATE PWC_E_STATISTICGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'STATISTICSGROUP is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_STATISTICGRP
	WHERE 
		STATISTICSGROUP= '' or STATISTICSGROUP is null

UPDATE PWC_E_STATISTICGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_STATISTICGRP
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_STATISTICGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'StatisticsGroup,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_STATISTICGRP
	WHERE
		StatisticsGroup IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND
		CONCAT(StatisticsGroup,DATAAREAID) IN 
		(SELECT CONCAT(StatisticsGroup,DATAAREAID) FROM PWC_E_STATISTICGRP
		GROUP BY StatisticsGroup,DATAAREAID HAVING COUNT(*)>1)








--------------- Price Customer Groups

UPDATE PWC_E_PRICECUSTGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_PRICECUSTGRP	
	WHERE 
		GROUPCODE= '' or GROUPCODE is null

UPDATE PWC_E_PRICECUSTGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_PRICECUSTGRP	
	WHERE 
		GROUPNAME= '' or GROUPNAME is null

UPDATE PWC_E_PRICECUSTGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_PRICECUSTGRP
	WHERE
		GROUPCODE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(GROUPCODE,DATAAREAID) IN 
		(SELECT CONCAT(GROUPCODE,DATAAREAID) FROM PWC_E_PRICECUSTGRP
		GROUP BY GROUPCODE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_PRICECUSTGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE is not there in CustomerGroupId of Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_PRICECUSTGRP A
	WHERE 
		GROUPCODE IS NOT NULL AND GROUPCODE NOT IN 
		(SELECT B.CustomerGroupId FROM PWC_E_CUSTOMERGROUP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerGroupId IS NOT NULL)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE is not there in SegmentCode of Customer Business segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		GROUPCODE IS NOT NULL AND GROUPCODE NOT IN 
		(SELECT B.SegmentCode FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)

UPDATE PWC_E_PRICECUSTGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE,GROUPNAME is not matching with CustomerGroupId,Description of Customer Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_PRICECUSTGRP A
	WHERE 
		CONCAT(GROUPCODE,GROUPNAME) NOT IN 
		(SELECT CONCAT(B.CustomerGroupId,B.Description) FROM PWC_E_CUSTOMERGROUP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CustomerGroupId IS NOT NULL)

UPDATE PWC_E_CUSTBUSINESSSEGMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPCODE,GROUPNAME is not matching with SegmentCode of Customer Business segments','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTBUSINESSSEGMENT A
	WHERE 
		CONCAT(GROUPCODE,GROUPNAME) NOT IN  
		(SELECT (B.SegmentCode,B.SegmentDescription) FROM PWC_E_CUSTBUSINESSSEGMENT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.SegmentCode IS NOT NULL)










--------------- Customer Classification Group Code ------------

UPDATE PWC_E_CUSTCLASSIFICATIONGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTCLASSIFICATIONGRP	
	WHERE 
		CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE= '' or CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE is null

UPDATE PWC_E_CUSTCLASSIFICATIONGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_CUSTCLASSIFICATIONGRP	
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_CUSTCLASSIFICATIONGRP
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTCLASSIFICATIONGRP
	WHERE
		CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(GROUPCODE,DATAAREAID) IN 
		(SELECT CONCAT(CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE,DATAAREAID) FROM PWC_E_CUSTCLASSIFICATIONGRP
		GROUP BY CUSTOMERPRIORITYCLASSIFICATIONGROUPCODE,DATAAREAID HAVING COUNT(*)>1)







------------- Customer Risk Score -------------

UPDATE PWC_E_CUSTRISKSCORE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'VALUE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_CUSTRISKSCORE	
	WHERE 
		VALUE LIKE '%[^0-9.]%'

UPDATE PWC_E_CUSTRISKSCORE
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTACCOUNT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTRISKSCORE	
	WHERE 
		CUSTACCOUNT= '' or CUSTACCOUNT is null

UPDATE PWC_E_CUSTRISKSCORE
	SET ERRORDESC = CONCAT(ERRORDESC,'RISKSCOREGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTRISKSCORE	
	WHERE 
		RISKSCOREGROUPID= '' or RISKSCOREGROUPID is null

UPDATE PWC_E_CUSTRISKSCORE
	SET ERRORDESC = CONCAT(ERRORDESC,'VALUE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTRISKSCORE	
	WHERE 
		VALUE= '' or VALUE is null

UPDATE PWC_E_CUSTRISKSCORE
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTACCOUNT, RISKSCOREGROUPID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_CUSTRISKSCORE
	WHERE
		CUSTACCOUNT IS NOT NULL AND RISKSCOREGROUPID IS NOT NULL AND DATAAREAID IS NOT NULL AND 
        CONCAT(CUSTACCOUNT,RISKSCOREGROUPID, DATAAREAID) IN 
		(SELECT CONCAT(CUSTACCOUNT,RISKSCOREGROUPID, DATAAREAID) FROM PWC_E_CUSTRISKSCORE
		GROUP BY CUSTACCOUNT,RISKSCOREGROUPID,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_CUSTRISKSCORE 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTACCOUNT is not there in CUSTOMERACCOUNT of Customer','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTRISKSCORE A	
	WHERE 
		CUSTACCOUNT IS NOT NULL AND CUSTACCOUNT NOT IN 
		(SELECT B.CUSTOMERCODELEGACY FROM PWC_E_CUSTOMERV3 B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.CUSTOMERCODELEGACY IS NOT NULL)

UPDATE PWC_E_CUSTRISKSCORE 
	SET ERRORDESC = CONCAT(ERRORDESC,'RISKSCOREGROUPID is not there in GROUPID of Scoring Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_CUSTRISKSCORE A	
	WHERE 
		RISKSCOREGROUPID IS NOT NULL AND RISKSCOREGROUPID NOT IN 
		(SELECT B.GROUPID FROM PWC_E_CREDITTBLSCORINGGRP B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.GROUPID IS NOT NULL)





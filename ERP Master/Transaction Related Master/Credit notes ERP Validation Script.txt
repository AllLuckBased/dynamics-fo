Credit notes Validation Script

Return Reason Code---

UPDATE PWC_E_ReturnReasonCodeStaging 
	SET ERRORDESC = CONCAT(ERRORDESC,'REASONCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ReturnReasonCodeStaging
	WHERE 
		REASONCODE= '' or REASONCODE is null

UPDATE PWC_E_ReturnReasonCodeStaging 
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERRETURNREASONCODEGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ReturnReasonCodeStaging
	WHERE 
		CUSTOMERRETURNREASONCODEGROUPID= '' or CUSTOMERRETURNREASONCODEGROUPID is null

UPDATE PWC_E_ReturnReasonCodeStaging 
	SET ERRORDESC = CONCAT(ERRORDESC,'REASONDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ReturnReasonCodeStaging
	WHERE 
		REASONDESCRIPTION= '' or REASONDESCRIPTION is null


UPDATE PWC_E_ReturnReasonCodeStaging 
	SET ERRORDESC = CONCAT(ERRORDESC,'REASONCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ReturnReasonCodeStaging
	WHERE 
		REASONCODE IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(REASONCODE,DATAAREAID) IN 
		(SELECT CONCAT(REASONCODE,DATAAREAID) FROM PWC_E_ReturnReasonCodeStaging
		GROUP BY REASONCODE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_ReturnReasonCodeStaging
	SET ERRORDESC = CONCAT(ERRORDESC,'CUSTOMERRETURNREASONCODEGROUPID is not there in GROUPID of Return Reason Code Groups','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ReturnReasonCodeStaging A
	WHERE 
		CUSTOMERRETURNREASONCODEGROUPID IS NOT NULL AND CUSTOMERRETURNREASONCODEGROUPID NOT IN 
		(SELECT B.GROUPID FROM PWC_E_ReturnReasonCodeGroupStaging B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(A.DATAAREAID) = 'GLOBAL' OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.GROUPID IS NOT NULL)








Return Reason Code Groups---


UPDATE PWC_E_ReturnReasonCodeGroupStaging
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ReturnReasonCodeGroupStaging
	WHERE 
		GROUPID= '' or GROUPID is null

UPDATE PWC_E_ReturnReasonCodeGroupStaging
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ReturnReasonCodeGroupStaging
	WHERE 
		GROUPDESCRIPTION= '' or GROUPDESCRIPTION is null

UPDATE PWC_E_ReturnReasonCodeGroupStaging
	SET ERRORDESC = CONCAT(ERRORDESC,'GROUPID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ReturnReasonCodeGroupStaging
	WHERE 
		GROUPID IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(GROUPID,DATAAREAID) IN 
		(SELECT CONCAT(GROUPID,DATAAREAID) FROM PWC_E_ReturnReasonCodeGroupStaging
		GROUP BY GROUPID,DATAAREAID HAVING COUNT(*)>1)
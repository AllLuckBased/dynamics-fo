Employee Master Validation Script


--->Job

JOBID is blank --- Error --- 2
DESCRIPTION is blank --- Warning --- 3
JOBDESCRIPTION is blank --- Warning --- 3
JOBTYPEID is blank --- Warning --- 3
TITLEID is blank --- Warning --- 3
JOBID has duplicate values --- Constraint --- 1


--->Department

OPERATINGUNITNUMBER is blank --- Error --- 2
NAME is blank --- Error --- 2
OPERATINGUNITTYPES is blank --- Error --- 2
LANGUAGE is blank --- Warning --- 3
ORGANIZATIONTYPE is blank --- Warning --- 3
PARTYTYPE is blank --- Warning --- 3

OMOperatingUnitType
OPERATINGUNITTYPES enum does not have valid enum values --- Error --- 2
OMInternalOrganizationType
ORGANIZATIONTYPE enum does not have valid enum values --- Error --- 2

OPERATINGUNITNUMBER,DATAAREAID has duplicate values --- Constraint --- 1

LANGUAGE is not there in LanguageCodeId of Language Codes --- Error --- 2



--->Employment V2

WORKERTYPE is blank --- Error --- 2
LEGALENTITYID is blank --- Error --- 2
EMPLOYMENTSTARTDATE is blank --- Error --- 2
PERSONNELNUMBER is blank --- Error --- 2
REGULATORYESTABLISHMENTID is blank --- Warning --- 3
EMPLOYMENTID is blank --- Warning --- 3

HcmEmploymentType
WORKERTYPE enum has invalid enum values --- Error --- 2

LEGALENTITYID is not there in Legal entity --- Error --- 2
PERSONNELNUMBER is not there in Employee --- Error --- 2
PERSONNELNUMBER,LEGALENTITYID,EMPLOYMENTID has duplicate values --- Constraint --- 1




Positions V2---

JobId is blank --- Error --- 2
PositionId is blank --- Warning --- 3
Description is blank --- Warning --- 3
DepartmentNumber is blank --- Warning --- 3
CompensationRegionId is blank --- Warning --- 3
TitleId is blank --- Warning --- 3
WorkerAssignmentStart is blank --- Warning --- 3
WorkerPersonnelNumber is blank --- Warning --- 3
WorkerAssignmentReasonCodeId is blank --- Warning --- 3
WorkerName is blank --- Warning --- 3
PayCycleId is blank --- Warning --- 3
AnnualRegularHours is blank --- Warning --- 3
PaidByLegalEntity is blank --- Warning --- 3

PositionId,DATAAREAID has duplicate values --- Constraint --- 1

DepartmentNumber is not there in NAME of Department --- Error --- 2
JobId is not there in JobId of Jobs--- Error --- 2
PaidByLegalEntity is not there in LEGALENTITYID of legal entities --- Error --- 2
WorkerPersonnelNumber is not there in PERSONNELNUMBER of Employee --- Error --- 2






-------------------------------- Validations Scripts ------------------------------------------


----- Employee

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC, 'EMPLOYMENTSTARTDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_EMPLOYEE
	WHERE
		EMPLOYMENTSTARTDATE IS NOT NULL AND ISDATE(EMPLOYMENTSTARTDATE) = 0

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC, 'EMPLOYMENTENDDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_EMPLOYEE
	WHERE
		EMPLOYMENTENDDATE IS NOT NULL AND ISDATE(EMPLOYMENTENDDATE) = 0

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'PERSONNELNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		PERSONNELNUMBER= '' or PERSONNELNUMBER is null

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'EMPLOYMENTLEGALENTITYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		EMPLOYMENTLEGALENTITYID= '' or EMPLOYMENTLEGALENTITYID is null

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'EMPLOYMENTLEGALENTITYID is not there in LEGALENTITYID of legal entities','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYEE A
	WHERE 
		EMPLOYMENTLEGALENTITYID IS NOT NULL AND EMPLOYMENTLEGALENTITYID NOT IN 
		(SELECT B.LEGALENTITYID FROM PWC_E_LEGALENTITY B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LEGALENTITYID IS NOT NULL)

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'FIRSTNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		FIRSTNAME= '' or FIRSTNAME is null

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		LANGUAGEID= '' or LANGUAGEID is null

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGEID is not there in LanguageCodeId of Language Codes','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYEE A	
	WHERE
		LANGUAGEID IS NOT NULL AND LANGUAGEID NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)


UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'PROFESSIONALTITLE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		PROFESSIONALTITLE= '' or PROFESSIONALTITLE is null

UPDATE PWC_E_EMPLOYEE
	SET ERRORDESC = CONCAT(ERRORDESC,'PERSONNELNUMBER,EMPLOYMENTLEGALENTITYID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_EMPLOYEE	
	WHERE 
		PERSONNELNUMBER IS NOT NULL AND
		EMPLOYMENTLEGALENTITYID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND 
		CONCAT(PERSONNELNUMBER,EMPLOYMENTLEGALENTITYID,DATAAREAID) IN 
		(SELECT CONCAT(PERSONNELNUMBER,EMPLOYMENTLEGALENTITYID,DATAAREAID) FROM PWC_E_EMPLOYEE
		GROUP BY CONCAT(PERSONNELNUMBER,EMPLOYMENTLEGALENTITYID,DATAAREAID) HAVING COUNT(*)>1)
























--- Job

UPDATE PWC_E_JOB 
	SET ERRORDESC = CONCAT(ERRORDESC,'JOBID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_JOB
	WHERE 
		JOBID= '' or JOBID is null

UPDATE PWC_E_JOB 
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_JOB
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_JOB 
	SET ERRORDESC = CONCAT(ERRORDESC,'JOBDESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_JOB
	WHERE 
		JOBDESCRIPTION= '' or JOBDESCRIPTION is null

UPDATE PWC_E_JOB 
	SET ERRORDESC = CONCAT(ERRORDESC,'JOBTYPEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_JOB
	WHERE 
		JOBTYPEID= '' or JOBTYPEID is null

UPDATE PWC_E_JOB 
	SET ERRORDESC = CONCAT(ERRORDESC,'TITLEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_JOB
	WHERE 
		TITLEID= '' or TITLEID is null

UPDATE PWC_E_JOB
	SET ERRORDESC = CONCAT(ERRORDESC,'JOBID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_JOB
	WHERE 
		JOBID IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(JOBID,DATAAREAID) IN 
		(SELECT CONCAT(JOBID,DATAAREAID) FROM PWC_E_JOB
		GROUP BY JOBID,DATAAREAID HAVING COUNT(*)>1)







---------- Department

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATINGUNITNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		OPERATINGUNITNUMBER= '' or OPERATINGUNITNUMBER is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		LANGUAGE= '' or LANGUAGE is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'NAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		NAME= '' or NAME is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATINGUNITTYPES is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		OPERATINGUNITTYPES= '' or OPERATINGUNITTYPES is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'ORGANIZATIONTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		ORGANIZATIONTYPE= '' or ORGANIZATIONTYPE is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'PARTYTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		PARTYTYPE= '' or PARTYTYPE is null

UPDATE PWC_E_DEPARTMENT 
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATINGUNITNUMBER,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE 
		OPERATINGUNITNUMBER IS NOT NULL AND
		DATAAREAID IS NOT NULL AND
		CONCAT(OPERATINGUNITNUMBER,DATAAREAID) IN 
		(SELECT CONCAT(OPERATINGUNITNUMBER,DATAAREAID) FROM PWC_E_DEPARTMENT
		GROUP BY OPERATINGUNITNUMBER,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_DEPARTMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'OPERATINGUNITTYPES enum does not have valid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE
		OPERATINGUNITTYPES IS NOT NULL AND OPERATINGUNITTYPES NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'OMOperatingUnitType')

UPDATE PWC_E_DEPARTMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'ORGANIZATIONTYPE enum does not have valid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT
	WHERE
		ORGANIZATIONTYPE IS NOT NULL AND ORGANIZATIONTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'OMInternalOrganizationType')


UPDATE PWC_E_DEPARTMENT
	SET ERRORDESC = CONCAT(ERRORDESC,'LANGUAGE is not there in LanguageCodeId of Language Codes','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_DEPARTMENT A
	WHERE 
		LANGUAGE IS NOT NULL AND LANGUAGE NOT IN 
		(SELECT B.LanguageCodeId FROM PWC_E_LANGUAGECODE B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(A.DATAAREAID) = 'GLOBAL' OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LanguageCodeId IS NOT NULL)














--- Employment V2

UPDATE PWC_E_EMPLOYMENTV2
	SET ERRORDESC = CONCAT(ERRORDESC, 'EMPLOYMENTSTARTDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_EMPLOYMENTV2
	WHERE
		EMPLOYMENTSTARTDATE IS NOT NULL AND ISDATE(EMPLOYMENTSTARTDATE) = 0

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'WORKERTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		WORKERTYPE= '' or WORKERTYPE is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'LEGALENTITYID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		LEGALENTITYID= '' or LEGALENTITYID is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'EMPLOYMENTSTARTDATE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		EMPLOYMENTSTARTDATE= '' or EMPLOYMENTSTARTDATE is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'PERSONNELNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		PERSONNELNUMBER= '' or PERSONNELNUMBER is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'REGULATORYESTABLISHMENTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		REGULATORYESTABLISHMENTID= '' or REGULATORYESTABLISHMENTID is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'EMPLOYMENTID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		EMPLOYMENTID= '' or EMPLOYMENTID is null

UPDATE PWC_E_EMPLOYMENTV2 
	SET ERRORDESC = CONCAT(ERRORDESC,'WORKERTYPE enum has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		WORKERTYPE IS NOT NULL AND WORKERTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'HcmEmploymentType')

UPDATE PWC_E_EMPLOYMENTV2
	SET ERRORDESC = CONCAT(ERRORDESC,'LEGALENTITYID is not there in Legal entity','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2	A
	WHERE 
		LEGALENTITYID IS NOT NULL AND LEGALENTITYID NOT IN 
		(SELECT B.LEGALENTITYID FROM PWC_E_LEGALENTITY B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LEGALENTITYID IS NOT NULL)

UPDATE PWC_E_EMPLOYMENTV2
	SET ERRORDESC = CONCAT(ERRORDESC,'PERSONNELNUMBER is not there in Employee','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_EMPLOYMENTV2 A	
	WHERE 
		PERSONNELNUMBER IS NOT NULL AND PERSONNELNUMBER NOT IN 
		(SELECT B.PERSONNELNUMBER FROM PWC_E_EMPLOYEE B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.PERSONNELNUMBER IS NOT NULL)

UPDATE PWC_E_EMPLOYMENTV2
	SET ERRORDESC = CONCAT(ERRORDESC,'PERSONNELNUMBER,LEGALENTITYID,EMPLOYMENTID,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_EMPLOYMENTV2	
	WHERE 
		PERSONNELNUMBER IS NOT NULL AND 
		LEGALENTITYID IS NOT NULL AND 
		EMPLOYMENTID IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND 
		CONCAT(PERSONNELNUMBER,LEGALENTITYID,EMPLOYMENTID,DATAAREAID) IN 
		(SELECT CONCAT(PERSONNELNUMBER,LEGALENTITYID,EMPLOYMENTID,DATAAREAID) FROM PWC_E_EMPLOYMENTV2
		GROUP BY CONCAT(PERSONNELNUMBER,LEGALENTITYID,EMPLOYMENTID,DATAAREAID) HAVING COUNT(*)>1)








Positions V2---

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'AnnualRegularHours is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING	
	WHERE 
		AnnualRegularHours LIKE '%[^0-9.]%'

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC, 'WorkerAssignmentStart HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE
		WorkerAssignmentStart IS NOT NULL AND ISDATE(WorkerAssignmentStart) = 0

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'WorkerAssignmentStart is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		WorkerAssignmentStart= '' or WorkerAssignmentStart is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'JobId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		JobId= '' or JobId is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PositionId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		PositionId= '' or PositionId is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'Description is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		Description= '' or Description is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'DepartmentNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		DepartmentNumber= '' or DepartmentNumber is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'TitleId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		TitleId= '' or TitleId is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'WorkerPersonnelNumber is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		WorkerPersonnelNumber= '' or WorkerPersonnelNumber is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'WorkerAssignmentReasonCodeId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		WorkerAssignmentReasonCodeId= '' or WorkerAssignmentReasonCodeId is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'WorkerName is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		WorkerName= '' or WorkerName is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PaidByLegalEntity is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		PaidByLegalEntity= '' or PaidByLegalEntity is null

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PositionId,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING
	WHERE 
		PositionId IS NOT NULL AND 
		DATAAREAID IS NOT NULL AND 
		CONCAT(PositionId,DATAAREAID) IN 
		(SELECT CONCAT(PositionId,DATAAREAID) FROM PWC_E_HCMPOSITIONV2STAGING
		GROUP BY PositionId,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'DepartmentNumber is not there in NAME of Department','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING A
	WHERE 
		DepartmentNumber IS NOT NULL AND DepartmentNumber NOT IN 
		(SELECT B.OPERATINGUNITNUMBER FROM PWC_E_DEPARTMENT B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.OPERATINGUNITNUMBER IS NOT NULL)

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'JobId is not there in JobId of Jobs','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING A
	WHERE 
		JobId IS NOT NULL AND JobId NOT IN 
		(SELECT B.JobId FROM PWC_E_JOB B WHERE B.ErrorDesc IS NULL AND B.ErrorDesc2 IS NULL AND (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.JobId IS NOT NULL)

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'WorkerPersonnelNumber is not there in PERSONNELNUMBER of Employee','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING A
	WHERE 
		WorkerPersonnelNumber IS NOT NULL AND WorkerPersonnelNumber NOT IN 
		(SELECT B.PERSONNELNUMBER FROM PWC_E_EMPLOYEE B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.PERSONNELNUMBER IS NOT NULL)

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'PaidByLegalEntity is not there in LEGALENTITYID of legal entities','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING A
	WHERE 
		PaidByLegalEntity IS NOT NULL AND PaidByLegalEntity NOT IN 
		(SELECT B.LEGALENTITYID FROM PWC_E_LEGALENTITY B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.LEGALENTITYID IS NOT NULL)

UPDATE PWC_E_HCMPOSITIONV2STAGING
	SET ERRORDESC = CONCAT(ERRORDESC,'JobId, TitleID is not matching with Jobs sumaster','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_HCMPOSITIONV2STAGING A
	WHERE 
		JobId IS NOT NULL AND TitleId IS NOT NULL AND CONCAT(JobId,TitleId) NOT IN 
		(SELECT CONCAT(B.JobId, B.TitleId) FROM PWC_E_JOB B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.JobId IS NOT NULL)











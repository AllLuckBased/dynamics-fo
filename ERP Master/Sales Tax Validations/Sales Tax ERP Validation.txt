Item Master ERP Pilot Validation script




--->Sales Tax Groups

TAXGROUPCODE is null --- Error --- 2
DESCRIPTION is null --- Warning --- 3
INVOICEPRINTDETAILS is null --- Warning --- 3
ROUNDINGBY is null --- Warning --- 3

TaxPrintDetail
INVOICEPRINTDETAILS has invalid enum values --- Error --- 2
TaxGroupRounding
ROUNDINGBY has invalid enum values --- Error --- 2

TAXGROUPCODE has duplicate values --- Constraint --- 1







----- Sales Tax Code

TAXCODE is null --- Error --- 2
TAXPOSTINGGROUPID is null --- Warning --- 3
TAXBASE is null --- Warning --- 3
TAXCALCULATIONMETHOD is null --- Warning --- 3
TAXCURRENCYCODEID is null --- Warning --- 3
TAXLIMITBASE is null --- Warning --- 3
TAXNAME is null --- Warning --- 3
TAXROUNDOFFTYPE is null --- Warning --- 3
PRINTCODETYPE is null --- Warning --- 3

TAXCODE has duplicate values --- Constraint --- 1

TaxBaseType
TAXBASE has invalid enum values --- Error --- 2
TaxCalcMode
TAXCALCULATIONMETHOD has invalid enum values --- Error --- 2
TaxLimitBase
TAXLIMITBASE has invalid enum values --- Error --- 2
RoundOffType
TAXROUNDOFFTYPE has invalid enum values --- Error --- 2
TaxWriteSelection
PRINTCODETYPE has invalid enum values --- Error --- 2

TAXCURRENCYCODEID is not there in CURRENCYCODE of currencies --- Error --- 2






--------> Sales Tax Code Values

TAXCODEID is null --- Error --- 2
VALUE is null --- Warning --- 3

TAXCODEID is not there in TAXCODE of Sales Tax Codes --- Error --- 2







-------> Item Sales Tax groups

ITEMSALESTAXGROUP is null --- Error --- 2
DESCRIPTION is null -Warning --- 3
COMPANY is null --- Warning --- 3

ITEMSALESTAXGROUP has dupicate values --- Constraint ---- 1

COMPANY there in LEGALENTITYID of legal entities --- Error --- 1







---------> Sales Tax Exempt Number

CountryRegionId is null --- Warning --- 3
Name is null --- Warning --- 3
VATNum is null --- Warning --- 3

VATNum, CountryRegionId has duplicate values --- Constraint --- 1

CountryRegionId is not there in COUNTRYREGION of country --- Error ---- 2






------> Sales tax Registraton Types

RegistrationType is null --- Error --- 2
CountryRegionId is null --- Warning --- 3
IsPrimaryAddressRestricted is null --- Warning --- 3
IsRegistrationNumberUnique is null --- Warning --- 3
IsRegistrationNumberUpdateable is null --- Warning --- 3
PartyTypeRestriction is null --- Warning --- 3

RegistrationType has duplicate values --- Constraint --- 1

PartyTypeRestriction
PartyTypeRestriction has invalid enum values --- Error --- 2

CountryRegionId is not there in COUNTRYREGION of country --- Error --- 2







----------------------------------Script for Validation---------------------------------------------------

--- Sales Tax Group

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXGROUPCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		TAXGROUPCODE= '' or TAXGROUPCODE is null

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'INVOICEPRINTDETAILS is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		INVOICEPRINTDETAILS= '' or INVOICEPRINTDETAILS is null

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'ROUNDINGBY is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		ROUNDINGBY= '' or ROUNDINGBY is null

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'INVOICEPRINTDETAILS has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		INVOICEPRINTDETAILS IS NOT NULL AND INVOICEPRINTDETAILS NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxPrintDetail')

UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'ROUNDINGBY has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		ROUNDINGBY IS NOT NULL AND ROUNDINGBY NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxGroupRounding')


UPDATE PWC_E_SALESTAXGROUPS
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXGROUPCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_SALESTAXGROUPS
	WHERE 
		TAXGROUPCODE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(TAXGROUPCODE,DATAAREAID) IN 
		(SELECT CONCAT(TAXGROUPCODE,DATAAREAID) FROM PWC_E_SALESTAXGROUPS
		GROUP BY TAXGROUPCODE,DATAAREAID HAVING COUNT(*)>1)


















--------- Sales Tax Codes



UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXCODE= '' or TAXCODE is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'SalesTaxType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		SalesTaxType= '' or SalesTaxType is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'PWCTAXREPORTINGCODE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		PWCTAXREPORTINGCODE= '' or PWCTAXREPORTINGCODE is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXPERIODID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXPERIODID= '' or TAXPERIODID is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXPOSTINGGROUPID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXPOSTINGGROUPID= '' or TAXPOSTINGGROUPID is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXBASE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXBASE= '' or TAXBASE is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCALCULATIONMETHOD is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXCALCULATIONMETHOD= '' or TAXCALCULATIONMETHOD is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCURRENCYCODEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXCURRENCYCODEID= '' or TAXCURRENCYCODEID is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXNAME is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXNAME= '' or TAXNAME is null

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXROUNDOFFTYPE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXROUNDOFFTYPE= '' or TAXROUNDOFFTYPE is null





UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCODE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE
		TAXCODE IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(TAXCODE,DATAAREAID) IN 
		(SELECT CONCAT(TAXCODE,DATAAREAID) FROM PWC_E_SALESTAXCODES
		GROUP BY TAXCODE,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXBASE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXBASE IS NOT NULL AND TAXBASE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxBaseType')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCALCULATIONMETHOD has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXCALCULATIONMETHOD IS NOT NULL AND TAXCALCULATIONMETHOD NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxCalcMode')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXLIMITBASE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXLIMITBASE IS NOT NULL AND TAXLIMITBASE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxLimitBase')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXROUNDOFFTYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		TAXROUNDOFFTYPE IS NOT NULL AND TAXROUNDOFFTYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'RoundOffType')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'PRINTCODETYPE has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		PRINTCODETYPE IS NOT NULL AND PRINTCODETYPE NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'TaxWriteSelection')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'SalesTaxType has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES
	WHERE 
		SalesTaxType IS NOT NULL AND SalesTaxType NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'PwCSalesTaxTypes')

UPDATE PWC_E_SALESTAXCODES
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCURRENCYCODEID is not there in CURRENCYCODE of currencies','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODES A
	WHERE 
		TAXCURRENCYCODEID IS NOT NULL AND TAXCURRENCYCODEID NOT IN 
		(SELECT B.CURRENCYCODE FROM PWC_E_CURRENCIES B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.CURRENCYCODE IS NOT NULL)
















--------> Sales Tax Code Values

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'RSP is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_SALESTAXCODEVAL	
	WHERE 
		RSP LIKE '%[^0-9.]%'

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'EXCISEPERCENTAGE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_SALESTAXCODEVAL	
	WHERE 
		EXCISEPERCENTAGE LIKE '%[^0-9.]%'

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC,'VALUE is not equal to RSP multiplied by EXCISEPERCENTAGE','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL
	WHERE 
		TRY_CAST(VALUE AS float) IS NOT NULL AND TRY_CAST(RSP AS float) IS NOT NULL AND TRY_CAST(EXCISEPERCENTAGE AS float) IS NOT NULL AND
		TRY_CAST(VALUE AS float) <> TRY_CAST(RSP AS float) * TRY_CAST(EXCISEPERCENTAGE AS float)

UPDATE V 
	SET V.ERRORDESC = CONCAT(ERRORDESC,'RSP is blank when TAXBASE of the Applicable Tax Code is AmountByUnit','; ')
	,V.ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL V
    JOIN PWC_E_SALESTAXCODES S 
    ON S.TAXCODE = V.TAXCODEID AND S.DATAAREAID = V.DATAAREAID
	WHERE 
		(V.RSP= '' or V.RSP is null) AND UPPER(S.TAXBASE) LIKE '%BYUNIT'

UPDATE V 
	SET V.ERRORDESC = CONCAT(ERRORDESC,'EXCISEPERCENTAGE is blank when TAXBASE of the Applicable Tax Code is AmountByUnit','; ')
	,V.ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL V
    JOIN PWC_E_SALESTAXCODES S 
    ON S.TAXCODE = V.TAXCODEID AND S.DATAAREAID = V.DATAAREAID
	WHERE 
		(V.EXCISEPERCENTAGE= '' or V.EXCISEPERCENTAGE is null) AND UPPER(S.TAXBASE) LIKE '%BYUNIT'

UPDATE V 
	SET V.ERRORDESC = CONCAT(ERRORDESC,'VALUE is blank when TAXBASE of the Applicable Tax Code is AmountByUnit','; ')
	,V.ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL V
    JOIN PWC_E_SALESTAXCODES S 
    ON S.TAXCODE = V.TAXCODEID AND S.DATAAREAID = V.DATAAREAID
	WHERE 
		(V.VALUE= '' or V.VALUE is null) AND UPPER(S.TAXBASE) LIKE '%BYUNIT'

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCODEID is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL
	WHERE 
		TAXCODEID= '' or TAXCODEID is null


UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCODEID,FROMDATE,TODATE,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_SALESTAXCODEVAL
	WHERE
		TAXCODEID IS NOT NULL AND DATAAREAID IS NOT NULL
		AND CONCAT(TAXCODEID,FROMDATE,TODATE, DATAAREAID) IN 
		(SELECT CONCAT(TAXCODEID,FROMDATE,TODATE,DATAAREAID) FROM PWC_E_SALESTAXCODEVAL
		GROUP BY TAXCODEID,FROMDATE,TODATE, DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC,'TAXCODEID is not there in TAXCODE of Sales Tax Codes','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXCODEVAL A
	WHERE 
		TAXCODEID IS NOT NULL AND TAXCODEID NOT IN 
		(SELECT B.TAXCODE FROM PWC_E_SALESTAXCODES B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.TAXCODE IS NOT NULL)

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC, 'FROMDATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_SALESTAXCODEVAL
	WHERE
		FROMDATE IS NOT NULL AND ISDATE(FROMDATE) = 0

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC = CONCAT(ERRORDESC, 'TODATE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_SALESTAXCODEVAL
	WHERE
		TODATE IS NOT NULL AND ISDATE(TODATE) = 0

UPDATE PWC_E_SALESTAXCODEVAL
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'VALUE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_SALESTAXCODEVAL	
	WHERE 
		VALUE LIKE '%[^0-9.]%'














-------> Item Sales Tax groups

UPDATE PWC_E_ITEMSALESTAXGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMSALESTAXGROUP is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_ITEMSALESTAXGROUP
	WHERE 
		ITEMSALESTAXGROUP= '' or ITEMSALESTAXGROUP is null

UPDATE PWC_E_ITEMSALESTAXGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'DESCRIPTION is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_ITEMSALESTAXGROUP
	WHERE 
		DESCRIPTION= '' or DESCRIPTION is null

UPDATE PWC_E_ITEMSALESTAXGROUP
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMSALESTAXGROUP,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_ITEMSALESTAXGROUP
	WHERE 
		ITEMSALESTAXGROUP IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(ITEMSALESTAXGROUP,DATAAREAID) IN 
		(SELECT CONCAT(ITEMSALESTAXGROUP,DATAAREAID) FROM PWC_E_ITEMSALESTAXGROUP
		GROUP BY ITEMSALESTAXGROUP,DATAAREAID HAVING COUNT(*)>1)



















---------- Sales Tax Exempt Numbers

PWC_E_SALESTAXEXEMPTNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXEXEMPTNUMBER
	WHERE 
		CountryRegionId= '' or CountryRegionId is null

PWC_E_SALESTAXEXEMPTNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'Name is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXEXEMPTNUMBER
	WHERE 
		Name= '' or Name is null

PWC_E_SALESTAXEXEMPTNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'VATNum is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXEXEMPTNUMBER
	WHERE 
		VATNum= '' or VATNum is null

PWC_E_SALESTAXEXEMPTNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'VATNum, CountryRegionId,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_SALESTAXEXEMPTNUMBER
	WHERE 
		VATNum IS NOT NULL AND CountryRegionId IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(VATNum,CountryRegionId,DATAAREAID) IN 
		(SELECT CONCAT(VATNum,CountryRegionId,DATAAREAID) FROM PWC_E_SALESTAXEXEMPTNUMBER
		GROUP BY VATNum,CountryRegionId,DATAAREAID HAVING COUNT(*)>1)

PWC_E_SALESTAXEXEMPTNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXEXEMPTNUMBER A
	WHERE 
		CountryRegionId IS NOT NULL AND CountryRegionId NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

















------> Sales tax Registraton Types

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'RegistrationType is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		RegistrationType= '' or RegistrationType is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		CountryRegionId= '' or CountryRegionId is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'IsPrimaryAddressRestricted is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		IsPrimaryAddressRestricted= '' or IsPrimaryAddressRestricted is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'IsRegistrationNumberUnique is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		IsRegistrationNumberUnique= '' or IsRegistrationNumberUnique is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'IsRegistrationNumberUpdateable is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		IsRegistrationNumberUpdateable= '' or IsRegistrationNumberUpdateable is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'PartyTypeRestriction is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Warning', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		PartyTypeRestriction= '' or PartyTypeRestriction is null

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'RegistrationType,DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		RegistrationType IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(RegistrationType,DATAAREAID) IN 
		(SELECT CONCAT(RegistrationType,DATAAREAID) FROM PWC_E_SALESTAXREGNUMBER
		GROUP BY RegistrationType,DATAAREAID HAVING COUNT(*)>1)

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'PartyTypeRestriction has invalid enum values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXREGNUMBER
	WHERE 
		PartyTypeRestriction IS NOT NULL AND PartyTypeRestriction NOT IN
		(SELECT MEMBERNAME FROM RETAILENUMVALUETABLE WHERE ENUMNAME LIKE 'PartyTypeRestriction')

PWC_E_SALESTAXREGNUMBER
	SET ERRORDESC = CONCAT(ERRORDESC,'CountryRegionId is not there in COUNTRYREGION of country','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_SALESTAXREGNUMBER A
	WHERE 
		CountryRegionId IS NOT NULL AND CountryRegionId NOT IN 
		(SELECT B.COUNTRYREGION FROM PWC_E_COUNTRYREGION B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(B.DATAAREAID) = 'GLOBAL') AND B.COUNTRYREGION IS NOT NULL)

















-------- Tax Declared Price 

UPDATE PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC, 'EFFECTIVE HAS WRONG DATE FORMAT','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'ERROR', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE
	EFFECTIVE IS NOT NULL AND ISDATE(EFFECTIVE) = 0

UPDATE PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'RSP is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_TAXDECLAREDPRICE	
	WHERE 
		RSP LIKE '%[^0-9.]%' AND RSP IS NOT NULL

UPDATE PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC2 = CONCAT(ERRORDESC2,'EXCISEPERCENTAGE is not a real number','; ')
	,ERRORSTATUS2 = CONCAT(ERRORSTATUS2, 'Constraint', '; ')
	FROM PWC_E_TAXDECLAREDPRICE	
	WHERE 
		EXCISEPERCENTAGE LIKE '%[^0-9.]%' AND EXCISEPERCENTAGE IS NOT NULL

PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'EFFECTIVE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		EFFECTIVE= '' or EFFECTIVE is null

PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		ITEMNUMBER= '' or ITEMNUMBER is null

PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'UNIT is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		UNIT= '' or UNIT is null

PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'RSP is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		RSP= '' or RSP is null

PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'EXCISEPERCENTAGE is blank','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		EXCISEPERCENTAGE= '' or EXCISEPERCENTAGE is null


PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'EFFECTIVE, ITEMNUMBER,UNIT, DATAAREAID has duplicate values','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Constraint', '; ')
	FROM PWC_E_TAXDECLAREDPRICE
	WHERE 
		EFFECTIVE IS NOT NULL AND ITEMNUMBER IS NOT NULL AND UNIT IS NOT NULL AND DATAAREAID IS NOT NULL AND CONCAT(EFFECTIVE,ITEMNUMBER,UNIT,DATAAREAID) IN 
		(SELECT CONCAT(EFFECTIVE,ITEMNUMBER,UNIT,DATAAREAID) FROM PWC_E_TAXDECLAREDPRICE
		GROUP BY EFFECTIVE,ITEMNUMBER,UNIT,DATAAREAID HAVING COUNT(*)>1)

UPDATE PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'ITEMNUMBER is not there in ITEMNUMBER of Released Products of PRODUCTTYPE = "item"','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE A
	WHERE 
		ITEMNUMBER IS NOT NULL AND ITEMNUMBER NOT IN 
		(SELECT B.ITEMNUMBER FROM PWC_E_ECORESRELEASEDPRODUCTV2STAGING B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(A.DATAAREAID) = 'GLOBAL' OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.ITEMNUMBER IS NOT NULL AND UPPER(B.PRODUCTTYPE) LIKE 'IT%')

UPDATE PWC_E_TAXDECLAREDPRICE
	SET ERRORDESC = CONCAT(ERRORDESC,'UNIT is not there in UnitSymbol of units','; ')
	,ERRORSTATUS = CONCAT(ERRORSTATUS, 'Error', '; ')
	FROM PWC_E_TAXDECLAREDPRICE A
	WHERE 
		UNIT IS NOT NULL AND UNIT NOT IN 
		(SELECT B.UnitSymbol FROM PWC_E_UNIT B WHERE (B.DATAAREAID = A.DATAAREAID OR UPPER(A.DATAAREAID) = 'GLOBAL' OR UPPER(B.DATAAREAID) = 'GLOBAL' OR UPPER(A.DATAAREAID) = 'GLOBAL') AND B.UnitSymbol IS NOT NULL)





